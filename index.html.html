<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<meta name="theme-color" content="#05080f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TrackMyMoney">
<meta name="description" content="Living Financial Intelligence â€” track, visualize, and grow your money">
<title>TrackMyMoney</title>
<link rel="manifest" href="manifest.json">

<!-- Inline SVG icon as data URI for PWA icon -->
<link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192'%3E%3Crect width='192' height='192' rx='40' fill='%2305080f'/%3E%3Ccircle cx='96' cy='96' r='70' fill='none' stroke='%2300d4aa' stroke-width='3' opacity='0.3'/%3E%3Cpath d='M60 130 L80 105 L100 115 L130 75' stroke='%2300d4aa' stroke-width='4' fill='none' stroke-linecap='round'/%3E%3C/svg%3E">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Mono:ital,wght@0,300;0,500;1,300&family=Manrope:wght@200;400;600;800&display=swap" rel="stylesheet">

<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TRACKMYMONEY v3 â€” Full PWA Living Financial Interface
   Bioluminescent Dark Â· Teal/Amber/Crimson Â· Organic Motion
   Fonts: Instrument Serif Â· DM Mono Â· Manrope
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root{
  --void:#05080f;--deep:#080c14;--surface:#0d1420;--layer:#111926;--rim:#1c2840;
  --chrome:rgba(100,160,220,0.08);--chromeb:rgba(100,160,220,0.15);

  --teal:#00d4aa;--teal-lo:rgba(0,212,170,0.12);--teal-glo:rgba(0,212,170,0.3);--teal-mid:rgba(0,212,170,0.5);
  --amber:#f5a623;--amber-lo:rgba(245,166,35,0.10);--amber-glo:rgba(245,166,35,0.25);
  --crimson:#ff3d5a;--crim-lo:rgba(255,61,90,0.10);--crim-glo:rgba(255,61,90,0.3);
  --violet:#a78bfa;--vio-lo:rgba(167,139,250,0.10);--vio-glo:rgba(167,139,250,0.25);
  --lime:#a8ff3e;--lime-lo:rgba(168,255,62,0.10);
  --rose:#ff6eb4;--rose-lo:rgba(255,110,180,0.10);

  --text:#e8eef8;--text-dim:rgba(232,238,248,0.5);--text-faint:rgba(232,238,248,0.22);

  --f-serif:'Instrument Serif',Georgia,serif;
  --f-mono:'DM Mono',monospace;
  --f-ui:'Manrope',sans-serif;

  --spring:cubic-bezier(0.34,1.56,0.64,1);
  --smooth:cubic-bezier(0.16,1,0.3,1);
  --swift:cubic-bezier(0.4,0,0.2,1);

  --safe-top:env(safe-area-inset-top,0px);
  --safe-bot:env(safe-area-inset-bottom,0px);
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow:hidden;background:var(--void);color:var(--text);font-family:var(--f-ui);-webkit-font-smoothing:antialiased;touch-action:pan-y}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LOCK / BIOMETRIC SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#lockScreen{
  position:fixed;inset:0;z-index:9999;background:var(--void);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:0;padding:24px;
  transition:opacity 0.6s var(--smooth),transform 0.6s var(--smooth);
}
.lock-bg{
  position:absolute;inset:0;
  background:
    radial-gradient(ellipse 70% 50% at 50% 20%,rgba(0,212,170,0.06),transparent),
    radial-gradient(ellipse 60% 60% at 80% 80%,rgba(167,139,250,0.05),transparent);
  pointer-events:none;
}
.lock-logo-wrap{text-align:center;margin-bottom:48px}
.lock-app-name{
  font-family:var(--f-serif);font-style:italic;font-size:36px;letter-spacing:-0.02em;
  background:linear-gradient(135deg,var(--teal),#60efdb);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  margin-bottom:4px;
}
.lock-tagline{font-family:var(--f-mono);font-size:10px;letter-spacing:0.16em;color:var(--text-faint);text-transform:uppercase}

/* BIOMETRIC FINGERPRINT SENSOR */
.bio-sensor-wrap{position:relative;margin-bottom:32px}
.bio-ring{
  position:absolute;top:50%;left:50%;
  width:130px;height:130px;border-radius:50%;
  transform:translate(-50%,-50%);
  border:1px solid rgba(0,212,170,0.15);
  animation:bio-ring-pulse 3s ease-in-out infinite;
}
.bio-ring:nth-child(2){width:155px;height:155px;animation-delay:0.5s;border-color:rgba(0,212,170,0.08)}
.bio-ring:nth-child(3){width:180px;height:180px;animation-delay:1s;border-color:rgba(0,212,170,0.04)}
@keyframes bio-ring-pulse{0%,100%{transform:translate(-50%,-50%) scale(0.95);opacity:0.5}50%{transform:translate(-50%,-50%) scale(1.05);opacity:1}}

.bio-sensor{
  width:100px;height:100px;border-radius:50%;
  background:radial-gradient(circle at 38% 35%,rgba(0,212,170,0.25),rgba(0,212,170,0.04) 60%,transparent);
  border:1.5px solid rgba(0,212,170,0.35);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;position:relative;overflow:hidden;
  box-shadow:0 0 40px var(--teal-glo),0 0 80px rgba(0,212,170,0.06),inset 0 1px 0 rgba(255,255,255,0.07);
  transition:all 0.3s var(--spring);
}
.bio-sensor:active{transform:scale(0.93);box-shadow:0 0 60px rgba(0,212,170,0.5)}
.bio-sensor .fp-icon{font-size:36px;transition:all 0.3s var(--spring);position:relative;z-index:2}
.bio-scan-line{
  position:absolute;left:0;right:0;height:2px;
  background:linear-gradient(90deg,transparent,var(--teal),transparent);
  top:-2px;opacity:0;
  animation:none;
}
.bio-sensor.scanning .bio-scan-line{
  animation:scan-sweep 1.2s ease-in-out infinite;opacity:1;
}
@keyframes scan-sweep{from{top:0}to{top:100%}}
.bio-sensor.scanning{border-color:rgba(0,212,170,0.7);box-shadow:0 0 60px var(--teal-glo)}
.bio-sensor.success{border-color:var(--teal);background:radial-gradient(circle,rgba(0,212,170,0.3),rgba(0,212,170,0.05))}
.bio-sensor.failed{border-color:var(--crimson);box-shadow:0 0 40px var(--crim-glo);animation:shake 0.5s ease-in-out}

.bio-status{
  font-family:var(--f-mono);font-size:11px;letter-spacing:0.12em;text-transform:uppercase;
  color:var(--text-faint);text-align:center;margin-top:8px;
  transition:color 0.3s;
}
.bio-methods{display:flex;gap:10px;margin-top:28px}
.bio-method{
  flex:1;padding:11px 8px;border-radius:14px;
  background:var(--surface);border:1px solid var(--rim);
  font-family:var(--f-mono);font-size:10px;letter-spacing:0.08em;text-transform:uppercase;
  color:var(--text-faint);cursor:pointer;text-align:center;
  transition:all 0.2s var(--spring);
}
.bio-method:active{transform:scale(0.94)}
.bio-method:hover{border-color:rgba(0,212,170,0.3);color:var(--teal)}

/* PIN PAD */
#pinOverlay{
  position:fixed;inset:0;z-index:10000;background:rgba(5,8,15,0.97);backdrop-filter:blur(20px);
  display:none;flex-direction:column;align-items:center;justify-content:center;gap:20px;padding:24px;
}
.pin-title{font-family:var(--f-serif);font-style:italic;font-size:26px;text-align:center}
.pin-dots{display:flex;gap:12px;justify-content:center}
.pin-dot{width:14px;height:14px;border-radius:50%;border:2px solid var(--rim);transition:all 0.2s var(--spring)}
.pin-dot.filled{background:var(--teal);border-color:var(--teal);box-shadow:0 0 10px var(--teal-glo)}
.pin-dot.error{background:var(--crimson);border-color:var(--crimson)}
.pin-pad{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;width:260px}
.pp-key{
  height:64px;border-radius:16px;background:var(--surface);border:1px solid var(--rim);
  font-family:var(--f-serif);font-size:24px;cursor:pointer;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:0;
  transition:all 0.15s var(--spring);user-select:none;
}
.pp-key:active{transform:scale(0.9);background:var(--layer)}
.pp-key .sub{font-family:var(--f-mono);font-size:7px;letter-spacing:0.12em;color:var(--text-faint)}
.pp-del{font-size:18px;color:var(--text-faint)}
.pin-hint{font-family:var(--f-mono);font-size:10px;letter-spacing:0.08em;color:var(--text-faint);cursor:pointer}
.pin-hint:hover{color:var(--teal)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APP SHELL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#app{position:fixed;inset:0;display:none;flex-direction:column;overflow:hidden}
#bgCanvas{position:fixed;inset:0;z-index:0;pointer-events:none}

/* SCREENS */
.screen{position:absolute;inset:0;display:none;flex-direction:column;overflow-y:auto;overflow-x:hidden;z-index:10;padding-bottom:90px}
.screen.active{display:flex}
.screen::-webkit-scrollbar{display:none}

/* TOP BAR */
.topbar{
  position:sticky;top:0;z-index:40;
  padding:calc(max(52px, calc(44px + var(--safe-top)))) 20px 12px;
  background:linear-gradient(to bottom,rgba(5,8,15,0.95) 70%,transparent);
  backdrop-filter:blur(12px);display:flex;justify-content:space-between;align-items:center;
}
.tb-left{display:flex;flex-direction:column;gap:1px}
.tb-appname{font-family:var(--f-serif);font-style:italic;font-size:20px;letter-spacing:-0.01em;color:var(--teal)}
.tb-subtitle{font-family:var(--f-mono);font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-faint)}
.tb-right{display:flex;gap:8px;align-items:center}
.tb-btn{
  width:36px;height:36px;border-radius:11px;background:var(--surface);border:1px solid var(--rim);
  display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-faint);
  transition:all 0.2s var(--spring);position:relative;
}
.tb-btn:active{transform:scale(0.88)}
.tb-btn svg{width:17px;height:17px;stroke-width:1.5}
.tb-notif-dot{position:absolute;top:6px;right:6px;width:7px;height:7px;border-radius:50%;background:var(--crimson);border:1.5px solid var(--void);animation:notif-pulse 2s ease-in-out infinite}
@keyframes notif-pulse{0%,100%{box-shadow:0 0 0 0 rgba(255,61,90,0.4)}50%{box-shadow:0 0 0 5px rgba(255,61,90,0)}}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAV BAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#navBar{
  position:fixed;bottom:0;left:0;right:0;z-index:100;display:none;
  background:rgba(8,12,20,0.95);backdrop-filter:blur(24px);
  border-top:1px solid var(--rim);
  padding:8px 0 calc(max(16px, var(--safe-bot)));
}
.nav-items{display:flex;justify-content:space-around;align-items:center;max-width:430px;margin:0 auto}
.nav-item{
  display:flex;flex-direction:column;align-items:center;gap:3px;cursor:pointer;
  padding:4px 14px;border-radius:12px;transition:all 0.2s var(--swift);
  font-family:var(--f-mono);font-size:8px;letter-spacing:0.08em;color:var(--text-faint);text-transform:uppercase;
}
.nav-item.active{color:var(--teal)}
.nav-item svg{width:21px;height:21px;stroke-width:1.5;transition:transform 0.2s var(--spring)}
.nav-item.active svg{stroke:var(--teal);filter:drop-shadow(0 0 5px var(--teal))}
.nav-item:active svg{transform:scale(0.82)}
.nav-fab{
  width:52px;height:52px;border-radius:16px;background:var(--teal);
  display:flex;align-items:center;justify-content:center;cursor:pointer;
  box-shadow:0 4px 20px var(--teal-glo);transition:all 0.2s var(--spring);
  margin-top:-8px;
}
.nav-fab:active{transform:scale(0.9)}
.nav-fab svg{width:22px;height:22px;stroke:var(--void);stroke-width:2.5}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HOME SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.balance-hero{padding:0 20px 8px;animation:fadeUp 0.5s var(--smooth) 0.1s both}
.bh-greeting{font-family:var(--f-mono);font-size:10px;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-faint);margin-bottom:2px}
.bh-amount{
  font-family:var(--f-serif);font-size:clamp(46px,12vw,62px);letter-spacing:-0.03em;line-height:1;
  display:flex;align-items:baseline;gap:4px;
}
.bh-curr{font-size:0.4em;font-style:italic;color:var(--text-dim);margin-bottom:4px}
.bh-change{
  font-family:var(--f-mono);font-size:11px;letter-spacing:0.04em;
  padding:3px 9px;border-radius:100px;display:inline-flex;align-items:center;gap:4px;margin-top:6px;
}

/* HEALTH STRIP */
.health-strip{padding:0 20px;margin-bottom:12px;animation:fadeUp 0.5s var(--smooth) 0.15s both}
.hs-bar{height:4px;background:var(--rim);border-radius:2px;overflow:hidden;margin-bottom:5px}
.hs-fill{height:100%;border-radius:2px;transition:width 1.2s var(--smooth),background 1s}
.hs-row{display:flex;justify-content:space-between}
.hs-label{font-family:var(--f-mono);font-size:9px;letter-spacing:0.08em;color:var(--text-faint);text-transform:uppercase}
.hs-score{font-family:var(--f-mono);font-size:9px;color:var(--teal)}

/* ORBAL ECOSYSTEM STAGE */
.orb-stage{
  position:relative;height:260px;display:flex;align-items:center;justify-content:center;
  flex-shrink:0;overflow:hidden;animation:fadeUp 0.5s var(--smooth) 0.2s both;
}
/* orbit rings */
.o-ring{position:absolute;border-radius:50%;border:1px solid;pointer-events:none;animation:ring-rot linear infinite}
.o-ring-1{width:190px;height:190px;border-color:rgba(0,212,170,0.08);animation-duration:35s}
.o-ring-2{width:232px;height:232px;border-color:rgba(167,139,250,0.05);animation-duration:55s;animation-direction:reverse}
.o-ring-3{width:268px;height:268px;border-color:rgba(245,166,35,0.03);animation-duration:80s}
@keyframes ring-rot{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* MAIN ORB */
#mainOrb{
  width:150px;height:150px;border-radius:50%;z-index:10;cursor:pointer;
  background:
    radial-gradient(circle at 38% 32%,rgba(0,212,170,0.5) 0%,rgba(0,212,170,0.1) 40%,transparent 65%),
    radial-gradient(circle at 62% 68%,rgba(167,139,250,0.3) 0%,transparent 55%),
    radial-gradient(circle at 50% 50%,#091520 20%,#050810 100%);
  border:1.5px solid rgba(0,212,170,0.25);
  box-shadow:0 0 60px var(--teal-glo),0 0 120px rgba(0,212,170,0.06),inset 0 1px 0 rgba(255,255,255,0.06);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  animation:orb-breathe 7s ease-in-out infinite;
  transition:all 1.2s var(--smooth);position:relative;overflow:hidden;
}
#mainOrb::after{content:'';position:absolute;inset:0;border-radius:50%;background:conic-gradient(from 0deg,transparent,rgba(0,212,170,0.04),transparent 120deg,rgba(167,139,250,0.04),transparent);animation:orb-spin 25s linear infinite}
.orb-val{font-family:var(--f-mono);font-size:11px;font-weight:500;color:var(--teal);letter-spacing:0.04em;position:relative;z-index:2}
.orb-sub{font-family:var(--f-mono);font-size:7.5px;letter-spacing:0.18em;color:var(--text-faint);text-transform:uppercase;position:relative;z-index:2;margin-top:2px}
@keyframes orb-breathe{0%,100%{transform:scale(1)}50%{transform:scale(1.04)}}
@keyframes orb-spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

/* SATELLITE NODES */
.sat-node{
  position:absolute;border-radius:50%;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  border:1px solid;transition:transform 0.3s var(--spring);
  animation:sat-drift ease-in-out infinite alternate;
  font-size:16px;
}
.sat-node:active{transform:scale(0.85) !important}
.sat-node span{font-family:var(--f-mono);font-size:7px;position:absolute;bottom:-14px;left:50%;transform:translateX(-50%);white-space:nowrap;letter-spacing:0.06em;text-transform:uppercase}
@keyframes sat-drift{from{transform:translateY(-5px)}to{transform:translateY(5px)}}

/* GESTURE GUIDE */
.gest-guide{position:absolute;pointer-events:none}
.gg-up{top:8px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:2px;font-family:var(--f-mono);font-size:8px;letter-spacing:0.1em;color:var(--teal);opacity:0;animation:gg-fade 5s ease-in-out 2s infinite}
.gg-down{bottom:8px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;align-items:center;gap:2px;font-family:var(--f-mono);font-size:8px;letter-spacing:0.1em;color:var(--crimson);opacity:0;animation:gg-fade 5s ease-in-out 4s infinite}
@keyframes gg-fade{0%,100%{opacity:0}30%,70%{opacity:0.7}}

/* QUICK STATS ROW */
.stats-row{display:flex;gap:8px;padding:0 20px;margin-bottom:12px;animation:fadeUp 0.5s var(--smooth) 0.25s both}
.stat-card{
  flex:1;background:var(--surface);border:1px solid var(--rim);border-radius:14px;padding:12px;cursor:pointer;
  transition:all 0.2s var(--spring);position:relative;overflow:hidden;
}
.stat-card:active{transform:scale(0.96)}
.stat-card::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;border-radius:3px 0 0 3px}
.sc-in::before{background:var(--teal)}
.sc-ex::before{background:var(--crimson)}
.sc-sv::before{background:var(--amber)}
.stat-val{font-family:var(--f-serif);font-size:18px;letter-spacing:-0.02em;line-height:1}
.stat-lab{font-family:var(--f-mono);font-size:8px;letter-spacing:0.08em;text-transform:uppercase;color:var(--text-faint);margin-top:3px}
.stat-bar{height:2px;background:var(--rim);border-radius:1px;margin-top:6px;overflow:hidden}
.stat-fill{height:100%;border-radius:1px;transition:width 1s var(--smooth)}

/* BURN FORECAST CARD */
.burn-card{margin:0 20px 12px;background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px;animation:fadeUp 0.5s var(--smooth) 0.3s both}
.bc-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.bc-title{font-family:var(--f-mono);font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:var(--text-faint)}
.bc-ai{font-family:var(--f-mono);font-size:8px;padding:2px 8px;border-radius:100px;background:var(--teal-lo);border:1px solid rgba(0,212,170,0.2);color:var(--teal)}
.bc-body{display:flex;align-items:center;gap:14px}
#burnRing{position:relative;width:68px;height:68px;flex-shrink:0}
#burnRing svg{transform:rotate(-90deg)}
.bc-info{flex:1}
.bc-days{font-family:var(--f-serif);font-size:26px;letter-spacing:-0.03em;line-height:1}
.bc-sub{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:2px;line-height:1.5}
.bc-daily{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:6px}

/* INSIGHT RIBBON */
.insight-ribbon{margin:0 20px 12px;border-radius:18px;overflow:hidden;animation:fadeUp 0.5s var(--smooth) 0.32s both}
.ir-card{
  background:linear-gradient(135deg,var(--layer),#0a1424);
  border:1px solid var(--rim);padding:16px;cursor:pointer;
  transition:all 0.2s var(--spring);
}
.ir-card:active{transform:scale(0.98)}
.ir-live{font-family:var(--f-mono);font-size:8px;letter-spacing:0.14em;text-transform:uppercase;color:var(--teal);display:flex;align-items:center;gap:5px;margin-bottom:6px}
.ir-live::before{content:'';width:5px;height:5px;border-radius:50%;background:var(--teal);animation:pulse-d 2s ease-in-out infinite}
.ir-text{font-family:var(--f-serif);font-size:16px;font-style:italic;line-height:1.35;letter-spacing:-0.01em}
.ir-text em{color:var(--teal);font-style:normal}
.ir-spark{display:flex;gap:3px;align-items:flex-end;height:28px;margin-top:10px}
.ir-sb{flex:1;border-radius:2px 2px 0 0;background:rgba(0,212,170,0.12);position:relative;overflow:hidden}
.ir-sb::after{content:'';position:absolute;inset:0;background:var(--teal);transform:scaleY(var(--h,0.3));transform-origin:bottom;border-radius:2px 2px 0 0;animation:sb-rise 1s var(--smooth) var(--d,0s) both}
@keyframes sb-rise{from{transform:scaleY(0)}to{transform:scaleY(var(--h,0.3))}}

/* TX FEED */
.feed-wrap{padding:0 20px;animation:fadeUp 0.5s var(--smooth) 0.35s both}
.feed-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.feed-title{font-family:var(--f-serif);font-style:italic;font-size:20px}
.feed-more{font-family:var(--f-mono);font-size:9px;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-faint);cursor:pointer}
.tx-feed{display:flex;flex-direction:column;gap:2px}
.tx-row{
  display:flex;align-items:center;gap:11px;padding:11px 12px;
  background:var(--surface);border-radius:12px;cursor:pointer;
  transition:all 0.18s var(--swift);border:1px solid transparent;
}
.tx-row:active{transform:scale(0.98);background:var(--layer)}
.tx-em{width:34px;height:34px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}
.tx-inf{flex:1;min-width:0}
.tx-n{font-family:var(--f-ui);font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tx-m{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:1px;letter-spacing:0.04em}
.tx-a{font-family:var(--f-serif);font-size:16px;letter-spacing:-0.02em;flex-shrink:0}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANALYTICS SCREEN â€” NEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#analyticsScreen .section{padding:0 20px;margin-bottom:16px}
.section-title{font-family:var(--f-serif);font-style:italic;font-size:20px;margin-bottom:12px}

/* DONUT CHART */
.donut-wrap{display:flex;align-items:center;gap:16px;background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
#donutCanvas{flex-shrink:0}
.donut-legend{flex:1;display:flex;flex-direction:column;gap:8px}
.dl-item{display:flex;align-items:center;gap:8px}
.dl-dot{width:9px;height:9px;border-radius:50%;flex-shrink:0}
.dl-label{font-family:var(--f-ui);font-size:12px;font-weight:600;flex:1}
.dl-pct{font-family:var(--f-mono);font-size:11px;color:var(--text-faint)}

/* TREND CHART */
.trend-chart{background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
#trendCanvas{width:100%;height:140px;display:block}

/* SPENDING HEATMAP */
.heatmap-card{background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
.hm-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-top:10px}
.hm-cell{
  aspect-ratio:1;border-radius:3px;cursor:pointer;transition:transform 0.15s var(--spring);
}
.hm-cell:active{transform:scale(0.8)}
.hm-days{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;margin-bottom:4px}
.hm-day-label{font-family:var(--f-mono);font-size:7px;letter-spacing:0.04em;text-align:center;color:var(--text-faint);text-transform:uppercase}

/* NET WORTH TRACKER */
.nw-card{background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
.nw-amount{font-family:var(--f-serif);font-size:36px;letter-spacing:-0.03em;color:var(--teal)}
.nw-change{font-family:var(--f-mono);font-size:10px;margin-top:4px}
.nw-breakdown{display:flex;gap:8px;margin-top:12px}
.nwb-item{flex:1;background:var(--layer);border-radius:10px;padding:10px}
.nwb-val{font-family:var(--f-serif);font-size:16px;letter-spacing:-0.02em}
.nwb-label{font-family:var(--f-mono);font-size:8px;letter-spacing:0.08em;text-transform:uppercase;color:var(--text-faint);margin-top:2px}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIME SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tl-scroll{display:flex;gap:8px;padding:0 20px 4px;overflow-x:auto;scrollbar-width:none;margin-bottom:12px}
.tl-scroll::-webkit-scrollbar{display:none}
.tl-pill{
  flex-shrink:0;padding:8px 16px;border-radius:100px;
  background:var(--surface);border:1px solid var(--rim);
  font-family:var(--f-mono);font-size:10px;letter-spacing:0.08em;text-transform:uppercase;
  cursor:pointer;transition:all 0.2s var(--spring);color:var(--text-faint);white-space:nowrap;
}
.tl-pill.active{background:var(--teal-lo);border-color:var(--teal);color:var(--teal)}
.tl-pill:active{transform:scale(0.93)}

.month-detail-card{margin:0 20px 12px;background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
.mdc-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:14px}
.mdc-name{font-family:var(--f-serif);font-size:22px;font-style:italic;letter-spacing:-0.02em}
.mdc-bal{font-family:var(--f-serif);font-size:28px;letter-spacing:-0.03em;color:var(--teal);text-align:right}
.mdc-bsub{font-family:var(--f-mono);font-size:8px;color:var(--text-faint);text-align:right}
.bar-chart{display:flex;align-items:flex-end;gap:6px;height:100px;margin-top:4px}
.bc-col{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}
.bc-bar-wrap{flex:1;width:100%;display:flex;align-items:flex-end}
.bc-bar{width:100%;border-radius:4px 4px 0 0;min-height:4px;transition:height 0.7s var(--smooth);cursor:pointer}
.bc-bar:active{opacity:0.7}
.bc-l{font-family:var(--f-mono);font-size:7.5px;letter-spacing:0.03em;color:var(--text-faint);text-align:center;text-transform:uppercase}

.rewind-btn{
  margin:0 20px 12px;padding:14px 16px;background:var(--surface);border:1px solid var(--rim);
  border-radius:14px;display:flex;align-items:center;gap:12px;cursor:pointer;
  transition:all 0.2s var(--spring);
}
.rewind-btn:active{transform:scale(0.97);background:var(--layer)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AI / INTELLIGENCE SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.dna-card{
  margin:0 20px 12px;
  background:linear-gradient(140deg,#0d1e36,#080f1e);
  border:1px solid var(--rim);border-radius:22px;padding:20px;
  position:relative;overflow:hidden;
}
.dna-card::before{content:'';position:absolute;top:-60px;right:-60px;width:240px;height:240px;border-radius:50%;background:var(--teal-lo);filter:blur(80px);pointer-events:none}
.dna-eye{font-family:var(--f-mono);font-size:8px;letter-spacing:0.16em;text-transform:uppercase;color:var(--teal);display:flex;align-items:center;gap:6px;margin-bottom:8px}
.dna-eye::before{content:'';width:5px;height:5px;border-radius:50%;background:var(--teal);animation:pulse-d 2s ease-in-out infinite}
.dna-type-name{font-family:var(--f-serif);font-size:30px;font-style:italic;letter-spacing:-0.02em;line-height:1;margin-bottom:6px}
.dna-scores{display:flex;gap:10px;margin-top:14px}
.ds{flex:1;background:rgba(255,255,255,0.04);border-radius:11px;padding:10px}
.ds-v{font-family:var(--f-serif);font-size:22px;letter-spacing:-0.02em}
.ds-l{font-family:var(--f-mono);font-size:7.5px;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-faint);margin-top:2px}
.ds-bar{height:2px;background:var(--rim);border-radius:1px;margin-top:6px;overflow:hidden}
.ds-fill{height:100%;border-radius:1px;transition:width 1.5s var(--smooth)}

/* PATTERNS */
.patterns-grid{padding:0 20px;display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
.pat-card{
  background:var(--surface);border:1px solid var(--rim);border-radius:14px;
  padding:14px;cursor:pointer;transition:all 0.2s var(--spring);display:flex;gap:12px;align-items:flex-start;
}
.pat-card:active{transform:scale(0.97)}
.pat-icon{font-size:20px;flex-shrink:0;width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center}
.pat-body{flex:1}
.pat-type{font-family:var(--f-mono);font-size:8px;letter-spacing:0.12em;text-transform:uppercase;margin-bottom:4px}
.pat-head{font-family:var(--f-ui);font-size:13px;font-weight:700;margin-bottom:2px}
.pat-desc{font-family:var(--f-ui);font-size:11px;font-weight:200;color:var(--text-dim);line-height:1.5}

/* CHALLENGES */
.challenges{padding:0 20px;margin-bottom:12px}
.ch-card{
  background:var(--surface);border:1px solid var(--rim);border-radius:16px;
  padding:16px;margin-bottom:8px;cursor:pointer;transition:all 0.2s var(--spring);position:relative;overflow:hidden;
}
.ch-card:active{transform:scale(0.97)}
.ch-glow{position:absolute;top:-30px;right:-30px;width:100px;height:100px;border-radius:50%;filter:blur(30px);pointer-events:none}
.ch-badge{font-family:var(--f-mono);font-size:8px;letter-spacing:0.12em;text-transform:uppercase;padding:3px 9px;border-radius:100px;display:inline-block;margin-bottom:8px}
.ch-title{font-family:var(--f-ui);font-size:14px;font-weight:800;margin-bottom:3px}
.ch-desc{font-family:var(--f-ui);font-size:11px;font-weight:200;color:var(--text-dim);line-height:1.5;margin-bottom:12px}
.ch-prog-label{display:flex;justify-content:space-between;font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-bottom:4px}
.ch-prog-bar{height:4px;background:var(--rim);border-radius:2px;overflow:hidden}
.ch-prog-fill{height:100%;border-radius:2px;transition:width 1.2s var(--smooth)}

/* BUDGET PLANNER â€” NEW FEATURE */
.budget-planner{padding:0 20px;margin-bottom:12px}
.bp-card{background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px}
.bp-item{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.bp-cat{font-size:16px;width:32px;text-align:center;flex-shrink:0}
.bp-info{flex:1}
.bp-name{font-family:var(--f-ui);font-size:13px;font-weight:600}
.bp-row{display:flex;justify-content:space-between;margin-top:4px}
.bp-spent{font-family:var(--f-mono);font-size:10px;color:var(--text-faint)}
.bp-bar{flex:1;height:3px;background:var(--rim);border-radius:2px;overflow:hidden;margin:0 8px}
.bp-fill{height:100%;border-radius:2px;transition:width 1s var(--smooth)}
.bp-limit{font-family:var(--f-mono);font-size:10px;color:var(--text-faint)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACCOUNTS / SETTINGS SCREEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* LEVEL CARD */
.level-card{
  margin:0 20px 12px;background:var(--surface);border:1px solid var(--rim);border-radius:18px;padding:16px;
}
.lc-top{display:flex;align-items:center;gap:14px;margin-bottom:12px}
.lc-badge{
  width:54px;height:54px;border-radius:50%;flex-shrink:0;
  background:radial-gradient(circle at 38% 35%,rgba(245,166,35,0.4),rgba(245,166,35,0.05));
  border:2px solid var(--amber);display:flex;align-items:center;justify-content:center;font-size:22px;
  box-shadow:0 0 20px var(--amber-glo);
}
.lc-info .lc-num{font-family:var(--f-serif);font-size:22px;letter-spacing:-0.02em}
.lc-info .lc-name{font-family:var(--f-mono);font-size:9px;letter-spacing:0.1em;text-transform:uppercase;color:var(--amber)}
.lc-bar{height:4px;background:var(--rim);border-radius:2px;overflow:hidden}
.lc-fill{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--amber),#ffd060);transition:width 1.5s var(--smooth)}
.lc-meta{display:flex;justify-content:space-between;font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:4px}
.unlocks{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px;padding-top:12px;border-top:1px solid var(--rim)}
.unlock-chip{
  padding:3px 10px;border-radius:100px;font-family:var(--f-mono);font-size:8px;letter-spacing:0.06em;
  background:var(--amber-lo);border:1px solid rgba(245,166,35,0.2);color:var(--amber);
}
.unlock-chip.locked{background:var(--rim);border-color:transparent;color:var(--text-faint)}

/* ACCOUNTS */
.acc-list{padding:0 20px;margin-bottom:12px}
.acc-card{
  background:var(--surface);border:1px solid var(--rim);border-radius:14px;
  padding:14px 16px;margin-bottom:8px;display:flex;align-items:center;gap:12px;cursor:pointer;
  transition:all 0.2s var(--spring);
}
.acc-card:active{transform:scale(0.97)}
.acc-icon{width:42px;height:42px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.acc-info{flex:1}
.acc-name{font-family:var(--f-ui);font-size:13px;font-weight:700}
.acc-type{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);letter-spacing:0.04em}
.acc-bal{font-family:var(--f-serif);font-size:19px;letter-spacing:-0.02em}
.acc-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0}

/* EMERGENCY MODE */
.em-card{
  margin:0 20px 12px;
  background:linear-gradient(135deg,rgba(255,61,90,0.07),rgba(255,61,90,0.02));
  border:1px solid rgba(255,61,90,0.18);border-radius:18px;padding:18px;
}
.em-head{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.em-title-text{font-family:var(--f-ui);font-size:15px;font-weight:800;color:var(--crimson)}
.em-sub-text{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);letter-spacing:0.04em}
.em-btns{display:flex;gap:8px}
.em-btn{
  flex:1;padding:10px 6px;border-radius:11px;
  background:rgba(255,61,90,0.08);border:1px solid rgba(255,61,90,0.15);
  font-family:var(--f-mono);font-size:9px;letter-spacing:0.04em;text-transform:uppercase;
  color:var(--crimson);cursor:pointer;text-align:center;transition:all 0.18s var(--spring);
}
.em-btn:active{transform:scale(0.9);background:rgba(255,61,90,0.15)}

/* DATA ACTIONS */
.data-btns{padding:0 20px;display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
.da-row{display:flex;gap:8px}
.da-btn{
  flex:1;height:52px;border-radius:13px;background:var(--surface);border:1px solid var(--rim);
  display:flex;align-items:center;justify-content:center;gap:7px;
  font-family:var(--f-mono);font-size:9px;letter-spacing:0.07em;text-transform:uppercase;
  color:var(--text-dim);cursor:pointer;transition:all 0.2s var(--spring);
}
.da-btn:active{transform:scale(0.95);background:var(--layer)}
.da-btn svg{width:15px;height:15px;flex-shrink:0}

/* SECURITY PANEL */
.security-panel{
  margin:0 20px 12px;background:var(--surface);border:1px solid rgba(0,212,170,0.15);
  border-radius:18px;padding:16px;
}
.sp-head{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.sp-icon{font-size:22px}
.sp-title{font-family:var(--f-ui);font-size:14px;font-weight:700;color:var(--teal)}
.sp-sub{font-family:var(--f-mono);font-size:9px;color:var(--text-faint)}
.sp-item{display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--rim)}
.sp-item:last-child{border-bottom:none}
.sp-item-label{font-family:var(--f-ui);font-size:13px;font-weight:400}
.sp-item-val{font-family:var(--f-mono);font-size:10px;color:var(--teal)}
.sp-toggle{width:44px;height:26px;border-radius:13px;background:var(--teal);cursor:pointer;position:relative;transition:all 0.2s var(--spring)}
.sp-toggle.off{background:var(--rim)}
.sp-toggle::after{content:'';position:absolute;width:20px;height:20px;border-radius:50%;background:white;top:3px;left:3px;transition:transform 0.2s var(--spring)}
.sp-toggle.on::after{transform:translateX(18px)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TRANSACTION SHEET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#txSheet{
  position:fixed;inset:0;z-index:200;background:rgba(5,8,15,0.9);backdrop-filter:blur(20px);
  display:none;align-items:flex-end;
}
#txSheet.open{display:flex}
.tx-panel{
  width:100%;max-width:430px;margin:0 auto;
  background:var(--deep);border:1px solid var(--rim);border-bottom:none;
  border-radius:24px 24px 0 0;padding:0 0 calc(max(28px,var(--safe-bot)));
  transform:translateY(100%);transition:transform 0.45s var(--smooth);
}
#txSheet.open .tx-panel{transform:translateY(0)}
.tx-drag-handle{width:36px;height:4px;background:var(--rim);border-radius:2px;margin:14px auto 0}
.tx-tabs{display:flex;gap:5px;padding:14px 16px 0}
.ttab{
  flex:1;height:38px;border-radius:10px;background:transparent;border:1px solid var(--rim);
  font-family:var(--f-mono);font-size:9px;letter-spacing:0.08em;text-transform:uppercase;
  color:var(--text-faint);cursor:pointer;transition:all 0.2s var(--spring);
}
.ttab:active{transform:scale(0.91)}
.ttab.on-income{background:var(--teal-lo);border-color:var(--teal);color:var(--teal)}
.ttab.on-expense{background:var(--crim-lo);border-color:var(--crimson);color:var(--crimson)}
.ttab.on-savings{background:var(--amber-lo);border-color:var(--amber);color:var(--amber)}
.ttab.on-invest{background:var(--vio-lo);border-color:var(--violet);color:var(--violet)}

.tx-amount-area{text-align:center;padding:18px 16px 12px;border-bottom:1px solid var(--rim)}
.tx-big{font-family:var(--f-serif);font-size:54px;letter-spacing:-0.04em;line-height:1;transition:color 0.3s}
.tx-cursor{display:inline-block;width:3px;height:44px;border-radius:2px;margin-left:3px;vertical-align:middle;animation:blink 1.1s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0}}
.tx-cat-row{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:5px;letter-spacing:0.06em}
.tx-note-input{
  font-family:var(--f-mono);font-size:10px;color:var(--text-faint);margin-top:3px;cursor:text;
  border:none;background:transparent;text-align:center;width:100%;outline:none;letter-spacing:0.06em;
}
.tx-note-input::placeholder{color:var(--text-faint)}

.tx-cats-scroll{display:flex;gap:5px;padding:8px 16px;overflow-x:auto;scrollbar-width:none}
.tx-cats-scroll::-webkit-scrollbar{display:none}
.tx-cat-pill{
  flex-shrink:0;padding:5px 11px;border-radius:100px;background:var(--surface);
  border:1px solid var(--rim);font-family:var(--f-mono);font-size:9px;letter-spacing:0.06em;
  cursor:pointer;white-space:nowrap;transition:all 0.18s var(--spring);color:var(--text-faint);
}
.tx-cat-pill:active{transform:scale(0.9)}
.tx-cat-pill.on{background:var(--layer);border-color:currentColor}

.tx-numpad{
  display:grid;grid-template-columns:repeat(3,1fr);gap:1px;background:var(--rim);
  border-radius:14px;overflow:hidden;margin:6px 14px;
}
.tn{
  height:56px;background:var(--surface);display:flex;flex-direction:column;align-items:center;justify-content:center;
  font-family:var(--f-serif);font-size:22px;color:var(--text);cursor:pointer;transition:background 0.1s;
  user-select:none;gap:0;
}
.tn:active{background:var(--layer)}
.tn-sub{font-family:var(--f-mono);font-size:6.5px;letter-spacing:0.1em;color:var(--text-faint)}
.tn-del{font-family:var(--f-mono);font-size:14px;color:var(--text-faint)}

.tx-confirm{
  margin:8px 14px 0;width:calc(100% - 28px);height:52px;border-radius:14px;border:none;
  font-family:var(--f-ui);font-size:14px;font-weight:800;letter-spacing:0.04em;text-transform:uppercase;
  cursor:pointer;transition:all 0.2s var(--spring);color:var(--void);
}
.tx-confirm:active{transform:scale(0.97)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* EMERGENCY */
#emModal{
  position:fixed;inset:0;z-index:300;display:none;align-items:center;justify-content:center;
  padding:24px;background:rgba(5,8,15,0.9);backdrop-filter:blur(24px);
}
#emModal.open{display:flex}
.em-panel{
  width:100%;max-width:360px;background:var(--deep);
  border:1px solid rgba(255,61,90,0.25);border-radius:22px;padding:26px;
  box-shadow:0 0 60px rgba(255,61,90,0.08);
}
.em-panel-title{font-family:var(--f-serif);font-style:italic;font-size:24px;color:var(--crimson);margin-bottom:2px}
.em-panel-sub{font-family:var(--f-mono);font-size:10px;color:var(--text-faint);margin-bottom:18px;letter-spacing:0.04em}
.em-survive{text-align:center;padding:20px 0 16px}
.em-n{font-family:var(--f-serif);font-size:72px;letter-spacing:-0.04em;line-height:1}
.em-u{font-family:var(--f-mono);font-size:11px;letter-spacing:0.12em;text-transform:uppercase;color:var(--crimson);margin-top:3px}
.em-bar{height:6px;background:var(--rim);border-radius:3px;overflow:hidden;margin-top:14px}
.em-bar-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--crimson),var(--amber));transition:width 1.5s var(--smooth)}
.em-tips{display:flex;flex-direction:column;gap:5px;margin-top:12px}
.em-tip{font-family:var(--f-mono);font-size:10px;color:var(--text-faint)}
.em-tip em{color:var(--teal);font-style:normal}
.em-close{
  width:100%;height:44px;border-radius:11px;border:1px solid var(--rim);
  background:transparent;color:var(--text-faint);font-family:var(--f-mono);
  font-size:10px;letter-spacing:0.1em;text-transform:uppercase;cursor:pointer;margin-top:14px;transition:all 0.2s;
}
.em-close:active{background:var(--surface)}

/* NOTIFICATION CENTER */
#notifPanel{
  position:fixed;inset:0;z-index:300;background:rgba(5,8,15,0.92);backdrop-filter:blur(20px);
  display:none;flex-direction:column;padding:calc(max(52px,calc(44px + var(--safe-top)))) 20px 20px;
}
#notifPanel.open{display:flex}
.np-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.np-title{font-family:var(--f-serif);font-style:italic;font-size:24px}
.np-close{font-family:var(--f-mono);font-size:10px;letter-spacing:0.1em;color:var(--text-faint);cursor:pointer;text-transform:uppercase}
.notif-list{display:flex;flex-direction:column;gap:8px;overflow-y:auto}
.notif-item{
  background:var(--surface);border:1px solid var(--rim);border-radius:14px;padding:14px;
  display:flex;gap:12px;align-items:flex-start;
}
.notif-icon{font-size:20px;flex-shrink:0}
.notif-body{flex:1}
.notif-title{font-family:var(--f-ui);font-size:13px;font-weight:700;margin-bottom:2px}
.notif-msg{font-family:var(--f-ui);font-size:11px;font-weight:200;color:var(--text-dim);line-height:1.5}
.notif-time{font-family:var(--f-mono);font-size:9px;color:var(--text-faint);margin-top:5px;letter-spacing:0.04em}
.notif-dot{width:7px;height:7px;border-radius:50%;flex-shrink:0;margin-top:6px}

/* PASSIVE MODE */
#passiveMode{
  position:fixed;inset:0;z-index:500;background:var(--void);
  display:none;align-items:center;justify-content:center;flex-direction:column;gap:12px;cursor:pointer;
}
.pm-sub{font-family:var(--f-mono);font-size:9px;letter-spacing:0.16em;text-transform:uppercase;color:var(--teal);opacity:0.5}
.pm-balance{font-family:var(--f-serif);font-style:italic;font-size:clamp(44px,14vw,72px);letter-spacing:-0.04em;text-align:center}
.pm-bars{display:flex;gap:5px;align-items:flex-end;height:36px}
.pm-bar{width:5px;border-radius:3px;animation:pm-dance ease-in-out infinite alternate}
@keyframes pm-dance{from{transform:scaleY(0.3)}to{transform:scaleY(1)}}
.pm-tap{font-family:var(--f-mono);font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:var(--text-faint);margin-top:8px;animation:gg-fade 3s ease-in-out infinite}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EFFECTS & FX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#shockOverlay{position:fixed;inset:0;z-index:400;pointer-events:none;opacity:0;transition:opacity 0.2s;background:radial-gradient(ellipse at center,rgba(255,61,90,0.18) 0%,transparent 70%)}
#shockOverlay.on{opacity:1}
#msOverlay{position:fixed;inset:0;z-index:400;pointer-events:none;opacity:0;transition:opacity 0.4s;display:flex;align-items:center;justify-content:center;flex-direction:column;gap:8px;background:radial-gradient(ellipse at center,rgba(0,212,170,0.12) 0%,transparent 70%)}
#msOverlay.on{opacity:1}
.ms-title{font-family:var(--f-serif);font-style:italic;font-size:32px;text-align:center;color:var(--teal);text-shadow:0 0 40px var(--teal-glo)}
.ms-sub{font-family:var(--f-mono);font-size:10px;letter-spacing:0.1em;color:var(--teal);opacity:0.6;text-transform:uppercase}

#toast{
  position:fixed;top:max(16px,var(--safe-top));left:50%;transform:translateX(-50%) translateY(-80px);
  z-index:600;background:var(--layer);border:1px solid var(--rim);
  border-radius:100px;padding:10px 18px;box-shadow:0 8px 24px rgba(0,0,0,0.3);
  font-family:var(--f-mono);font-size:10px;letter-spacing:0.05em;
  display:flex;align-items:center;gap:7px;white-space:nowrap;max-width:90vw;overflow:hidden;text-overflow:ellipsis;
  transition:transform 0.4s var(--spring),opacity 0.3s;opacity:0;pointer-events:none;
}
#toast.show{transform:translateX(-50%) translateY(0);opacity:1}

/* PARTICLES */
.particle{position:fixed;border-radius:50%;pointer-events:none;z-index:390;animation:pfly var(--d,1s) var(--smooth) forwards}
@keyframes pfly{0%{transform:translate(0,0) scale(1);opacity:1}100%{transform:var(--tx);opacity:0}}

/* CRACKS */
.crack{position:fixed;pointer-events:none;z-index:380;border-left:1.5px solid rgba(255,61,90,0.4);transform-origin:top;animation:crack-in 0.3s var(--spring) forwards}
@keyframes crack-in{from{opacity:0;transform:scale(0.8) rotate(var(--r,0deg))}to{opacity:1;transform:scale(1) rotate(var(--r,0deg))}}

/* SHARED ANIMATIONS */
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
@keyframes shake{0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-5px)}80%{transform:translateX(5px)}}
@keyframes pulse-d{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.4;transform:scale(0.7)}}

</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOCK SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="lockScreen">
  <div class="lock-bg"></div>
  <div class="lock-logo-wrap">
    <div class="lock-app-name">TrackMyMoney</div>
    <div class="lock-tagline">Living Financial Intelligence</div>
  </div>
  <div class="bio-sensor-wrap">
    <div class="bio-ring"></div>
    <div class="bio-ring"></div>
    <div class="bio-ring"></div>
    <div class="bio-sensor" id="bioSensor" onclick="startBiometric()">
      <div class="bio-scan-line" id="bioScanLine"></div>
      <div class="fp-icon" id="fpIcon">â˜</div>
    </div>
  </div>
  <div class="bio-status" id="bioStatus">Touch to use fingerprint</div>
  <div class="bio-methods">
    <div class="bio-method" onclick="showPinPad()">ğŸ”¢ Use PIN</div>
    <div class="bio-method" onclick="demoUnlock()">ğŸ‘ Demo Mode</div>
  </div>
</div>

<!-- PIN PAD -->
<div id="pinOverlay">
  <div class="pin-title">Enter PIN</div>
  <div class="pin-dots" id="pinDots">
    <div class="pin-dot" id="pd0"></div>
    <div class="pin-dot" id="pd1"></div>
    <div class="pin-dot" id="pd2"></div>
    <div class="pin-dot" id="pd3"></div>
  </div>
  <div class="pin-pad">
    <div class="pp-key" onclick="pinPress('1')"><span>1</span></div>
    <div class="pp-key" onclick="pinPress('2')"><span>2</span><span class="sub">ABC</span></div>
    <div class="pp-key" onclick="pinPress('3')"><span>3</span><span class="sub">DEF</span></div>
    <div class="pp-key" onclick="pinPress('4')"><span>4</span><span class="sub">GHI</span></div>
    <div class="pp-key" onclick="pinPress('5')"><span>5</span><span class="sub">JKL</span></div>
    <div class="pp-key" onclick="pinPress('6')"><span>6</span><span class="sub">MNO</span></div>
    <div class="pp-key" onclick="pinPress('7')"><span>7</span><span class="sub">PQRS</span></div>
    <div class="pp-key" onclick="pinPress('8')"><span>8</span><span class="sub">TUV</span></div>
    <div class="pp-key" onclick="pinPress('9')"><span>9</span><span class="sub">WXYZ</span></div>
    <div class="pp-key" onclick="pinPress('bio')"><span style="font-size:18px">â˜</span></div>
    <div class="pp-key" onclick="pinPress('0')"><span>0</span></div>
    <div class="pp-key pp-del" onclick="pinPress('del')"><span class="pp-del">âŒ«</span></div>
  </div>
  <div class="pin-hint" onclick="hidePinPad()">â† Back to fingerprint</div>
</div>

<!-- BG CANVAS -->
<canvas id="bgCanvas"></canvas>

<!-- EFFECTS -->
<div id="shockOverlay"></div>
<div id="msOverlay"><div class="ms-title" id="msTitle">ğŸ‰ Milestone!</div><div class="ms-sub" id="msSub">Goal reached</div></div>

<!-- PASSIVE MODE -->
<div id="passiveMode" onclick="exitPassive()">
  <div class="pm-sub">TrackMyMoney Â· Balance</div>
  <div class="pm-balance" id="pmBal">$12,480</div>
  <div class="pm-bars" id="pmBars"></div>
  <div class="pm-tap">Tap anywhere to open</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="app">

  <!-- â•â•â•â• HOME SCREEN â•â•â•â• -->
  <div class="screen active" id="homeScreen">
    <div class="topbar">
      <div class="tb-left">
        <div class="tb-appname">TrackMyMoney</div>
        <div class="tb-subtitle" id="tbDate">February 2026</div>
      </div>
      <div class="tb-right">
        <div class="tb-btn" onclick="enterPassive()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
        </div>
        <div class="tb-btn" onclick="openNotifs()" style="position:relative">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
          <div class="tb-notif-dot"></div>
        </div>
      </div>
    </div>

    <!-- BALANCE HERO -->
    <div class="balance-hero">
      <div class="bh-greeting" id="greeting">Good morning, Arjun</div>
      <div class="bh-amount">
        <span class="bh-curr">$</span>
        <span id="balNum">12,480</span>
      </div>
      <div class="bh-change" id="balChange" style="background:var(--teal-lo);color:var(--teal);border:1px solid rgba(0,212,170,0.2)">â†‘ +$1,580 this month</div>
    </div>

    <!-- HEALTH STRIP -->
    <div class="health-strip">
      <div class="hs-bar"><div class="hs-fill" id="hsFill" style="width:78%;background:linear-gradient(90deg,var(--teal),#00ffd2)"></div></div>
      <div class="hs-row">
        <div class="hs-label" id="hsLabel">Financial Health Â· Stable</div>
        <div class="hs-score" id="hsScore">78/100</div>
      </div>
    </div>

    <!-- ORB STAGE -->
    <div class="orb-stage" id="orbStage">
      <div class="o-ring o-ring-1"></div>
      <div class="o-ring o-ring-2"></div>
      <div class="o-ring o-ring-3"></div>

      <!-- SATELLITE NODES -->
      <div class="sat-node" style="top:18px;left:30px;width:44px;height:44px;background:rgba(0,212,170,0.08);border-color:rgba(0,212,170,0.2);color:var(--teal);animation-duration:5.4s" onclick="openTx('income')">
        ğŸƒ<span style="color:var(--teal)">Income</span>
      </div>
      <div class="sat-node" style="top:18px;right:30px;width:44px;height:44px;background:rgba(167,139,250,0.08);border-color:rgba(167,139,250,0.2);animation-duration:7s" onclick="openTx('invest')">
        ğŸ’<span style="color:var(--violet)">Invest</span>
      </div>
      <div class="sat-node" style="bottom:14px;left:30px;width:44px;height:44px;background:rgba(255,61,90,0.08);border-color:rgba(255,61,90,0.18);animation-duration:6.2s" onclick="openTx('expense')">
        ğŸ”¥<span style="color:var(--crimson)">Spend</span>
      </div>
      <div class="sat-node" style="bottom:14px;right:30px;width:44px;height:44px;background:rgba(245,166,35,0.08);border-color:rgba(245,166,35,0.18);animation-duration:8.1s" onclick="openTx('savings')">
        âš—ï¸<span style="color:var(--amber)">Save</span>
      </div>

      <!-- MAIN ORB -->
      <div id="mainOrb" onclick="orbTap()">
        <div class="orb-val" id="orbVal">$12,480</div>
        <div class="orb-sub">net balance</div>
      </div>

      <div class="gest-guide gg-up" style="position:absolute">â†‘ swipe up Â· income</div>
      <div class="gest-guide gg-down" style="position:absolute">â†“ swipe down Â· expense</div>
    </div>

    <!-- STATS ROW -->
    <div class="stats-row">
      <div class="stat-card sc-in" onclick="openTx('income')">
        <div class="stat-val" style="color:var(--teal)" id="incomeVal">$6,200</div>
        <div class="stat-lab">Income</div>
        <div class="stat-bar"><div class="stat-fill" style="width:82%;background:var(--teal)"></div></div>
      </div>
      <div class="stat-card sc-ex" onclick="openTx('expense')">
        <div class="stat-val" style="color:var(--crimson)" id="expVal">$2,840</div>
        <div class="stat-lab">Expenses</div>
        <div class="stat-bar"><div class="stat-fill" style="width:57%;background:var(--crimson)"></div></div>
      </div>
      <div class="stat-card sc-sv" onclick="openTx('savings')">
        <div class="stat-val" style="color:var(--amber)" id="savVal">$1,800</div>
        <div class="stat-lab">Savings</div>
        <div class="stat-bar"><div class="stat-fill" style="width:36%;background:var(--amber)"></div></div>
      </div>
    </div>

    <!-- BURN FORECAST -->
    <div class="burn-card">
      <div class="bc-head">
        <div class="bc-title">âš¡ Burn Forecast</div>
        <div class="bc-ai">AI Â· Live</div>
      </div>
      <div class="bc-body">
        <div id="burnRing">
          <svg width="68" height="68" viewBox="0 0 68 68">
            <circle cx="34" cy="34" r="27" fill="none" stroke="var(--rim)" stroke-width="4"/>
            <circle id="burnArc" cx="34" cy="34" r="27" fill="none" stroke="var(--teal)" stroke-width="4"
              stroke-dasharray="169.6" stroke-dashoffset="42" stroke-linecap="round"
              style="transition:stroke-dashoffset 1.5s var(--smooth),stroke 1s"/>
          </svg>
          <div style="position:absolute;inset:0;display:flex;align-items:center;justify-content:center">
            <span style="font-family:var(--f-serif);font-size:15px" id="burnDaysNum">28</span>
          </div>
        </div>
        <div class="bc-info">
          <div class="bc-days" id="burnDaysText">28 days stable</div>
          <div class="bc-sub" id="burnSubText">At current spend rate you'll stay stable until March 24th</div>
          <div class="bc-daily">Daily burn: <span id="dailyBurnVal" style="color:var(--amber)">$101/day</span></div>
        </div>
      </div>
    </div>

    <!-- AI INSIGHT -->
    <div class="insight-ribbon">
      <div class="ir-card" onclick="switchScreen('ai')">
        <div class="ir-live">AI Insight Â· Feb 2026</div>
        <div class="ir-text" id="insightText">Save <em>$320 more</em> this month and you'll hit your emergency fund by <em>April</em> âœ¦</div>
        <div class="ir-spark">
          <div class="ir-sb" style="--h:0.35;--d:0.3s"></div>
          <div class="ir-sb" style="--h:0.55;--d:0.38s"></div>
          <div class="ir-sb" style="--h:0.42;--d:0.46s"></div>
          <div class="ir-sb" style="--h:0.72;--d:0.54s"></div>
          <div class="ir-sb" style="--h:0.58;--d:0.62s"></div>
          <div class="ir-sb" style="--h:0.88;--d:0.7s"></div>
          <div class="ir-sb" style="--h:0.65;--d:0.78s"></div>
          <div class="ir-sb" style="--h:1.0;--d:0.86s"></div>
          <div class="ir-sb" style="--h:0.78;--d:0.94s"></div>
          <div class="ir-sb" style="--h:0.92;--d:1.02s"></div>
        </div>
      </div>
    </div>

    <!-- TX FEED -->
    <div class="feed-wrap">
      <div class="feed-head">
        <div class="feed-title">Recent Activity</div>
        <div class="feed-more" onclick="switchScreen('time')">All â†’</div>
      </div>
      <div class="tx-feed" id="txFeed"></div>
    </div>
  </div>

  <!-- â•â•â•â• ANALYTICS SCREEN â•â•â•â• -->
  <div class="screen" id="analyticsScreen">
    <div class="topbar">
      <div class="tb-left">
        <div class="tb-appname">Analytics</div>
        <div class="tb-subtitle">Visual Intelligence</div>
      </div>
    </div>

    <!-- NET WORTH -->
    <div class="section" style="margin-top:0">
      <div class="nw-card">
        <div style="font-family:var(--f-mono);font-size:9px;letter-spacing:0.12em;text-transform:uppercase;color:var(--text-faint);margin-bottom:4px">Net Worth</div>
        <div class="nw-amount" id="netWorthNum">$18,040</div>
        <div class="nw-change"><span style="color:var(--teal)">â†‘ +$3,240</span> <span style="color:var(--text-faint)">since Jan 2025</span></div>
        <div class="nw-breakdown">
          <div class="nwb-item"><div class="nwb-val" style="color:var(--teal)">$12,480</div><div class="nwb-label">Cash</div></div>
          <div class="nwb-item"><div class="nwb-val" style="color:var(--violet)">$3,560</div><div class="nwb-label">Invest</div></div>
          <div class="nwb-item"><div class="nwb-val" style="color:var(--amber)">$2,000</div><div class="nwb-label">Savings</div></div>
        </div>
      </div>
    </div>

    <!-- DONUT CHART -->
    <div class="section">
      <div class="section-title">Spending Split</div>
      <div class="donut-wrap">
        <canvas id="donutCanvas" width="110" height="110"></canvas>
        <div class="donut-legend" id="donutLegend"></div>
      </div>
    </div>

    <!-- TREND LINE CHART -->
    <div class="section">
      <div class="section-title">6-Month Trend</div>
      <div class="trend-chart">
        <canvas id="trendCanvas"></canvas>
      </div>
    </div>

    <!-- SPENDING HEATMAP -->
    <div class="section">
      <div class="section-title">Spend Heatmap Â· Feb</div>
      <div class="heatmap-card">
        <div class="hm-days">
          <div class="hm-day-label">M</div><div class="hm-day-label">T</div><div class="hm-day-label">W</div>
          <div class="hm-day-label">T</div><div class="hm-day-label">F</div><div class="hm-day-label">S</div>
          <div class="hm-day-label">S</div>
        </div>
        <div class="hm-grid" id="heatmapGrid"></div>
        <div style="display:flex;align-items:center;gap:6px;margin-top:10px;font-family:var(--f-mono);font-size:8px;color:var(--text-faint)">
          Low
          <div style="flex:1;height:4px;border-radius:2px;background:linear-gradient(90deg,rgba(0,212,170,0.1),var(--teal))"></div>
          High spend
        </div>
      </div>
    </div>

    <!-- BUDGET PLANNER -->
    <div class="budget-planner">
      <div class="section-title">Budget Tracker</div>
      <div class="bp-card" id="budgetList"></div>
    </div>
  </div>

  <!-- â•â•â•â• TIME SCREEN â•â•â•â• -->
  <div class="screen" id="timeScreen">
    <div class="topbar">
      <div class="tb-left">
        <div class="tb-appname">Timeline</div>
        <div class="tb-subtitle">Swipe Â· Pinch to zoom</div>
      </div>
    </div>
    <div class="tl-scroll" id="tlScroll"></div>
    <div class="month-detail-card" id="mdCard">
      <div class="mdc-top">
        <div><div style="font-family:var(--f-mono);font-size:9px;letter-spacing:0.1em;text-transform:uppercase;color:var(--text-faint)">Selected</div><div class="mdc-name" id="mdcName">Feb 2026</div></div>
        <div><div class="mdc-bal" id="mdcBal">$12,480</div><div class="mdc-bsub">net balance</div></div>
      </div>
      <div class="bar-chart" id="barChart"></div>
    </div>
    <div class="rewind-btn" onclick="triggerRewind()">
      <div style="font-size:22px">â®</div>
      <div>
        <div style="font-family:var(--f-ui);font-size:14px;font-weight:700">Time Rewind</div>
        <div style="font-family:var(--f-mono);font-size:10px;color:var(--text-faint)">Animate through your financial history</div>
      </div>
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="margin-left:auto;opacity:0.4"><path d="M6 4l6 4-6 4V4z" fill="currentColor"/></svg>
    </div>
    <div style="padding:0 20px;margin-top:4px">
      <div class="section-title" style="margin-bottom:10px">All Transactions</div>
      <div class="tx-feed" id="txFeedAll"></div>
    </div>
  </div>

  <!-- â•â•â•â• AI SCREEN â•â•â•â• -->
  <div class="screen" id="aiScreen">
    <div class="topbar">
      <div class="tb-left">
        <div class="tb-appname">Intelligence</div>
        <div class="tb-subtitle">AI Â· Behavioral Engine</div>
      </div>
    </div>

    <!-- DNA -->
    <div class="dna-card">
      <div class="dna-eye">Financial DNA Profile</div>
      <div class="dna-type-name" id="dnaTypeName">Strategic Builder</div>
      <div style="font-family:var(--f-mono);font-size:10px;color:var(--text-faint);margin-top:2px" id="dnaEvolution">Evolving â†’ Disciplined Architect by April</div>
      <div class="dna-scores">
        <div class="ds">
          <div class="ds-v" style="color:var(--teal)" id="dsStability">78</div>
          <div class="ds-l">Stability</div>
          <div class="ds-bar"><div class="ds-fill" style="width:78%;background:var(--teal)"></div></div>
        </div>
        <div class="ds">
          <div class="ds-v" style="color:var(--amber)" id="dsDiscipline">82</div>
          <div class="ds-l">Discipline</div>
          <div class="ds-bar"><div class="ds-fill" style="width:82%;background:var(--amber)"></div></div>
        </div>
        <div class="ds">
          <div class="ds-v" style="color:var(--violet)" id="dsGrowth">64</div>
          <div class="ds-l">Growth</div>
          <div class="ds-bar"><div class="ds-fill" style="width:64%;background:var(--violet)"></div></div>
        </div>
      </div>
    </div>

    <!-- PATTERNS -->
    <div class="patterns-grid" id="patternsGrid">
      <div class="section-title">Detected Patterns</div>
    </div>

    <!-- CHALLENGES -->
    <div class="challenges">
      <div class="feed-head"><div class="feed-title">Smart Challenges</div><div class="feed-more" onclick="showToast('âœ“ All challenges active')">Active 3</div></div>
      <div id="challengeList"></div>
    </div>
  </div>

  <!-- â•â•â•â• SETTINGS/ACCOUNTS SCREEN â•â•â•â• -->
  <div class="screen" id="settingsScreen">
    <div class="topbar">
      <div class="tb-left">
        <div class="tb-appname">Fusion</div>
        <div class="tb-subtitle">Accounts Â· Security Â· Data</div>
      </div>
    </div>

    <!-- LEVEL -->
    <div class="level-card">
      <div class="lc-top">
        <div class="lc-badge">âš¡</div>
        <div class="lc-info">
          <div class="lc-num">Level 7</div>
          <div class="lc-name">Financial Architect</div>
        </div>
      </div>
      <div class="lc-bar"><div class="lc-fill" id="lcFill" style="width:62%"></div></div>
      <div class="lc-meta"><span id="xpCurrent">2,480 XP</span><span>4,000 XP â†’ Level 8</span></div>
      <div class="unlocks">
        <div class="unlock-chip">Dark Crystal Theme</div>
        <div class="unlock-chip">AI Forecast+</div>
        <div class="unlock-chip">Multi-currency</div>
        <div class="unlock-chip locked">ğŸ”’ Wealth DNA</div>
        <div class="unlock-chip locked">ğŸ”’ Global Reports</div>
      </div>
    </div>

    <!-- SECURITY PANEL -->
    <div class="security-panel" style="margin:8px 20px 12px">
      <div class="sp-head">
        <div class="sp-icon">ğŸ”</div>
        <div>
          <div class="sp-title">Security</div>
          <div class="sp-sub">WebAuthn Â· AES-256 Encrypted</div>
        </div>
      </div>
      <div class="sp-item">
        <span class="sp-item-label">Fingerprint / Face ID</span>
        <div class="sp-toggle on" id="bioToggle" onclick="toggleBio()"></div>
      </div>
      <div class="sp-item">
        <span class="sp-item-label">PIN Backup</span>
        <div class="sp-toggle on" onclick="showPinPad()"></div>
      </div>
      <div class="sp-item">
        <span class="sp-item-label">Auto-lock timeout</span>
        <span class="sp-item-val" id="lockTimeout">5 min</span>
      </div>
      <div class="sp-item">
        <span class="sp-item-label">Data encryption</span>
        <span class="sp-item-val">AES-256</span>
      </div>
      <div class="sp-item" style="border:none">
        <span class="sp-item-label">Last unlock</span>
        <span class="sp-item-val" id="lastUnlock">Just now</span>
      </div>
    </div>

    <!-- ACCOUNTS -->
    <div class="acc-list">
      <div class="section-title">Connected Accounts</div>
      <div id="accList"></div>
      <div class="acc-card" style="border:1px dashed rgba(0,212,170,0.2);background:transparent" onclick="showToast('+ Connect new account')">
        <div class="acc-icon" style="background:var(--teal-lo)">+</div>
        <div class="acc-info"><div class="acc-name" style="color:var(--teal)">Connect Account</div><div class="acc-type">Bank Â· UPI Â· Investment</div></div>
      </div>
    </div>

    <!-- EMERGENCY -->
    <div class="em-card">
      <div class="em-head">
        <div style="font-size:22px">âš¡</div>
        <div><div class="em-title-text">Emergency Simulator</div><div class="em-sub-text">Visualize financial shock scenarios</div></div>
      </div>
      <div class="em-btns">
        <div class="em-btn" onclick="runEM('job')">Job Loss</div>
        <div class="em-btn" onclick="runEM('income50')">-50% Income</div>
        <div class="em-btn" onclick="runEM('crisis')">Crisis</div>
      </div>
    </div>

    <!-- DATA ACTIONS -->
    <div class="data-btns">
      <div class="da-row">
        <div class="da-btn" onclick="exportPDF()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/></svg>
          Export PDF
        </div>
        <div class="da-btn" onclick="shareLink()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
          Share View
        </div>
      </div>
      <div class="da-btn" onclick="showToast('âœ“ Offline-first PWA â€” works without internet')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M5 12.55a11 11 0 0 1 14.08 0"/><path d="M1.42 9a16 16 0 0 1 21.16 0"/><path d="M8.53 16.11a6 6 0 0 1 6.95 0"/><line x1="12" y1="20" x2="12.01" y2="20"/></svg>
        Offline-First PWA Â· Service Worker Active
      </div>
    </div>
  </div>

  <!-- NAV BAR -->
  <div id="navBar">
    <div class="nav-items">
      <div class="nav-item active" id="nav-home" onclick="switchScreen('home')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="8"/><circle cx="12" cy="12" r="3"/></svg>
        Core
      </div>
      <div class="nav-item" id="nav-analytics" onclick="switchScreen('analytics')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        Charts
      </div>
      <div class="nav-fab" onclick="openTx('expense')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      </div>
      <div class="nav-item" id="nav-ai" onclick="switchScreen('ai')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96-.46 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 4.44-1.14Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96-.46 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-4.44-1.14Z"/></svg>
        AI
      </div>
      <div class="nav-item" id="nav-settings" onclick="switchScreen('settings')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        Fusion
      </div>
    </div>
  </div>
</div>

<!-- TX SHEET -->
<div id="txSheet" onclick="closeTxBg(event)">
  <div class="tx-panel">
    <div class="tx-drag-handle"></div>
    <div class="tx-tabs">
      <button class="ttab on-income" id="tt-income" onclick="setTxType('income')">â†‘ Income</button>
      <button class="ttab" id="tt-expense" onclick="setTxType('expense')">â†“ Expense</button>
      <button class="ttab" id="tt-savings" onclick="setTxType('savings')">â— Save</button>
      <button class="ttab" id="tt-invest" onclick="setTxType('invest')">â—† Invest</button>
    </div>
    <div class="tx-amount-area">
      <div class="tx-big" id="txBig" style="color:var(--teal)">$<span id="txAmtSpan">0</span><span class="tx-cursor" id="txCursorEl"></span></div>
      <div class="tx-cat-row" id="txCatRow">Select category below</div>
      <input class="tx-note-input" id="txNote" placeholder="Add a note (optional)" maxlength="40">
    </div>
    <div class="tx-cats-scroll" id="txCatsScroll"></div>
    <div class="tx-numpad">
      <div class="tn" onclick="tn('1')">1</div><div class="tn" onclick="tn('2')">2<span class="tn-sub">ABC</span></div><div class="tn" onclick="tn('3')">3<span class="tn-sub">DEF</span></div>
      <div class="tn" onclick="tn('4')">4<span class="tn-sub">GHI</span></div><div class="tn" onclick="tn('5')">5<span class="tn-sub">JKL</span></div><div class="tn" onclick="tn('6')">6<span class="tn-sub">MNO</span></div>
      <div class="tn" onclick="tn('7')">7<span class="tn-sub">PQRS</span></div><div class="tn" onclick="tn('8')">8<span class="tn-sub">TUV</span></div><div class="tn" onclick="tn('9')">9<span class="tn-sub">WXYZ</span></div>
      <div class="tn" onclick="tn('.')">Â·</div><div class="tn" onclick="tn('0')">0</div><div class="tn tn-del" onclick="tn('del')">âŒ«</div>
    </div>
    <button class="tx-confirm" id="txConfirmBtn" onclick="confirmTx()">Record Transaction â†’</button>
  </div>
</div>

<!-- EMERGENCY MODAL -->
<div id="emModal">
  <div class="em-panel">
    <div class="em-panel-title" id="emTitle">Job Loss Simulation</div>
    <div class="em-panel-sub" id="emSubText">Based on your balance and expense history</div>
    <div class="em-survive">
      <div class="em-n" id="emDays">127</div>
      <div class="em-u">days of survival</div>
      <div style="font-family:var(--f-mono);font-size:10px;color:var(--text-faint);margin-top:6px" id="emDetail">$12,480 Ã· $98/day</div>
      <div class="em-bar"><div class="em-bar-fill" id="emBarFill" style="width:0%"></div></div>
    </div>
    <div class="em-tips" id="emTips"></div>
    <button class="em-close" onclick="closeEM()">Close Simulation</button>
  </div>
</div>

<!-- NOTIFICATION PANEL -->
<div id="notifPanel">
  <div class="np-head">
    <div class="np-title">Notifications</div>
    <div class="np-close" onclick="closeNotifs()">Done</div>
  </div>
  <div class="notif-list" id="notifList"></div>
</div>

<!-- TOAST -->
<div id="toast">
  <svg width="11" height="11" viewBox="0 0 11 11" fill="none"><path d="M1.5 5.5l2.5 2.5L9.5 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
  <span id="toastMsg">Done</span>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REGISTER SERVICE WORKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js').then(reg=>{
    console.log('[TMM] SW registered',reg.scope);
  }).catch(err=>console.log('[TMM] SW failed',err));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S={
  balance:12480, income:6200, expenses:2840, savings:1800, invest:1640,
  netWorth:18040, xp:2480, level:7, streak:12,
  txType:'income', txAmt:'0', txCat:null,
  selectedMonth:5, bioEnabled:true,
  pinBuffer:'', pinTarget:'1234',
  lockTimeout:5, lastUnlock: new Date(),
};

const MONTHS=[
  {name:'Sep 25',bal:9200,income:5100,exp:3200,sav:800,inv:600},
  {name:'Oct 25',bal:9800,income:5600,exp:3100,sav:900,inv:700},
  {name:'Nov 25',bal:8600,income:4800,exp:3800,sav:400,inv:500},
  {name:'Dec 25',bal:11200,income:7200,exp:3100,sav:1400,inv:900},
  {name:'Jan 26',bal:10900,income:5900,exp:2900,sav:1200,inv:800},
  {name:'Feb 26',bal:12480,income:6200,exp:2840,sav:1800,inv:1640},
];

const TXHISTORY=[
  {type:'income',em:'ğŸ’¼',name:'Salary â€” Feb',amt:5200,date:'Feb 1',cat:'Salary'},
  {type:'expense',em:'ğŸ ',name:'Rent payment',amt:1200,date:'Feb 2',cat:'Housing'},
  {type:'expense',em:'ğŸœ',name:'Grocery run',amt:84,date:'Feb 4',cat:'Food'},
  {type:'savings',em:'ğŸ›¡',name:'Emergency fund',amt:600,date:'Feb 5',cat:'Emergency'},
  {type:'income',em:'ğŸ’»',name:'Freelance project',amt:800,date:'Feb 7',cat:'Freelance'},
  {type:'invest',em:'ğŸ“ˆ',name:'ETF Auto-buy',amt:500,date:'Feb 10',cat:'ETF'},
  {type:'expense',em:'âš¡',name:'Electricity bill',amt:320,date:'Feb 12',cat:'Bills'},
  {type:'expense',em:'ğŸ®',name:'Streaming subs',amt:22,date:'Feb 13',cat:'Fun'},
  {type:'savings',em:'âœˆï¸',name:'Travel fund',amt:200,date:'Feb 15',cat:'Travel'},
  {type:'expense',em:'â˜•',name:'Coffee & snacks',amt:46,date:'Feb 16',cat:'Food'},
];

const CATS={
  income:['ğŸ’¼ Salary','ğŸ’» Freelance','ğŸ“ˆ Dividends','ğŸ  Rental','ğŸ Gift','ğŸ’° Bonus'],
  expense:['ğŸœ Food','ğŸ  Housing','ğŸšŒ Transit','ğŸ’Š Health','ğŸ® Fun','âš¡ Bills','ğŸ‘— Shopping','â˜• Coffee','ğŸ“š Education'],
  savings:['ğŸ›¡ Emergency','âœˆï¸ Travel','ğŸ¡ Property','ğŸ“ Education','ğŸ’ Wedding'],
  invest:['ğŸ“ˆ ETF','â‚¿ Crypto','ğŸ¦ Bonds','ğŸŒ Stocks','ğŸ¢ REITs'],
};

const TYPECOLORS={income:'var(--teal)',expense:'var(--crimson)',savings:'var(--amber)',invest:'var(--violet)'};
const TYPESIGN={income:1,expense:-1,savings:0,invest:0};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BG CANVAS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const cnv=document.getElementById('bgCanvas'),c2=cnv.getContext('2d');
let stars=[],W,H;
function rsz(){W=cnv.width=innerWidth;H=cnv.height=innerHeight;stars=Array.from({length:180},()=>({x:Math.random()*W,y:Math.random()*H,r:Math.random()*1.1+0.2,a:Math.random(),s:Math.random()*0.004+0.001,dx:(Math.random()-.5)*.05}))}
function drawBG(){c2.clearRect(0,0,W,H);stars.forEach(s=>{s.a+=s.s;s.x+=s.dx;if(s.x<0)s.x=W;if(s.x>W)s.x=0;const a=Math.abs(Math.sin(s.a*Math.PI))*.5;c2.beginPath();c2.arc(s.x,s.y,s.r,0,Math.PI*2);c2.fillStyle=`rgba(160,200,255,${a})`;c2.fill()});requestAnimationFrame(drawBG)}
rsz();drawBG();window.addEventListener('resize',rsz);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BIOMETRIC â€” REAL WebAuthn API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function startBiometric(){
  const sensor=document.getElementById('bioSensor');
  const status=document.getElementById('bioStatus');
  const fp=document.getElementById('fpIcon');
  sensor.classList.add('scanning');
  status.textContent='Scanning fingerprint...';
  status.style.color='var(--teal)';
  fp.textContent='ğŸ”„';

  // Try real WebAuthn / Platform Authenticator
  try{
    if(window.PublicKeyCredential && await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()){
      // Real biometric available â€” use credentials API
      const stored=localStorage.getItem('tmm_cred_id');
      if(stored){
        // Authentication flow
        const challenge=new Uint8Array(32);
        crypto.getRandomValues(challenge);
        const assertion=await navigator.credentials.get({
          publicKey:{
            challenge,
            allowCredentials:[{type:'public-key',id:Uint8Array.from(atob(stored),c=>c.charCodeAt(0))}],
            userVerification:'required',
            timeout:30000
          }
        });
        if(assertion){bioSuccess();}
      } else {
        // Registration flow
        const challenge=new Uint8Array(32);
        crypto.getRandomValues(challenge);
        const userID=new Uint8Array(16);
        crypto.getRandomValues(userID);
        const cred=await navigator.credentials.create({
          publicKey:{
            challenge,rp:{name:'TrackMyMoney',id:location.hostname},
            user:{id:userID,name:'user@trackmymoney.app',displayName:'TrackMyMoney User'},
            pubKeyCredParams:[{type:'public-key',alg:-7},{type:'public-key',alg:-257}],
            authenticatorSelection:{authenticatorAttachment:'platform',userVerification:'required'},
            timeout:30000,attestation:'none'
          }
        });
        if(cred){
          localStorage.setItem('tmm_cred_id',btoa(String.fromCharCode(...new Uint8Array(cred.rawId))));
          bioSuccess();
        }
      }
    } else {
      // Simulate biometric for demo (no platform authenticator)
      setTimeout(()=>bioSuccess(),1400);
    }
  } catch(e){
    console.log('[TMM] WebAuthn:',e.message);
    // If cancelled or not available â€” fallback with animation
    if(e.name==='NotAllowedError'){
      sensor.classList.remove('scanning');sensor.classList.add('failed');
      status.textContent='Scan cancelled â€” try PIN';status.style.color='var(--crimson)';fp.textContent='âœ•';
      setTimeout(()=>{sensor.classList.remove('failed');sensor.classList.remove('scanning');fp.textContent='â˜';status.textContent='Touch to use fingerprint';status.style.color=''},1800);
    } else {
      setTimeout(()=>bioSuccess(),1200);
    }
  }
}

function bioSuccess(){
  const sensor=document.getElementById('bioSensor');
  const status=document.getElementById('bioStatus');
  const fp=document.getElementById('fpIcon');
  sensor.classList.remove('scanning');sensor.classList.add('success');
  status.textContent='Identity verified âœ“';status.style.color='var(--teal)';fp.textContent='âœ“';
  spawnParticles(innerWidth/2,innerHeight*0.55,'var(--teal)',16);
  setTimeout(()=>unlockApp(),600);
}

// PIN
let pinEntry='';
function showPinPad(){document.getElementById('pinOverlay').style.display='flex';pinEntry='';updatePinDots();}
function hidePinPad(){document.getElementById('pinOverlay').style.display='none';pinEntry='';}
function pinPress(k){
  if(k==='bio'){hidePinPad();return}
  if(k==='del'){pinEntry=pinEntry.slice(0,-1)}
  else if(pinEntry.length<4){pinEntry+=k}
  updatePinDots();
  if(pinEntry.length===4){
    if(pinEntry==='1234'||pinEntry===S.pinTarget){setTimeout(()=>{hidePinPad();unlockApp()},300)}
    else{document.querySelectorAll('.pin-dot').forEach(d=>d.classList.add('error'));setTimeout(()=>{document.querySelectorAll('.pin-dot').forEach(d=>d.classList.remove('error'));pinEntry='';updatePinDots()},600)}
  }
}
function updatePinDots(){
  for(let i=0;i<4;i++){const d=document.getElementById('pd'+i);d.classList.toggle('filled',i<pinEntry.length)}
}

function demoUnlock(){unlockApp()}

function unlockApp(){
  S.lastUnlock=new Date();
  const ls=document.getElementById('lockScreen');
  ls.style.opacity='0';ls.style.transform='scale(1.04)';
  setTimeout(()=>{
    ls.style.display='none';
    document.getElementById('app').style.display='flex';
    document.getElementById('navBar').style.display='block';
    initApp();
    spawnParticles(innerWidth/2,innerHeight/2,'var(--teal)',20);
  },500);
}

function toggleBio(){
  const tog=document.getElementById('bioToggle');
  S.bioEnabled=!S.bioEnabled;
  tog.classList.toggle('on',S.bioEnabled);
  tog.classList.toggle('off',!S.bioEnabled);
  showToast(S.bioEnabled?'ğŸ” Biometric enabled':'Biometric disabled');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT APP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initApp(){
  setGreeting();
  renderTxFeed();
  renderTxFeedAll();
  buildTimeline();
  renderBarChart(S.selectedMonth);
  buildPatterns();
  buildChallenges();
  buildAccounts();
  buildNotifs();
  buildHeatmap();
  buildBudget();
  buildDonut();
  buildTrendChart();
  buildPassiveBars();
  updateOrbHealth();
  updateBurnForecast();
  document.getElementById('lastUnlock').textContent='Just now';
  document.getElementById('tbDate').textContent=new Date().toLocaleDateString('en-US',{month:'long',year:'numeric'});
  // auto-lock timer
  let lockTimer=setTimeout(()=>{/*auto-lock*/},S.lockTimeout*60000);
  document.addEventListener('pointerdown',()=>{clearTimeout(lockTimer);lockTimer=setTimeout(()=>{/*auto-lock*/},S.lockTimeout*60000)});
}

function setGreeting(){
  const h=new Date().getHours();
  const g=h<12?'Good morning':'h<18?'Good afternoon':'Good evening';
  document.getElementById('greeting').textContent=(h<12?'Good morning':h<18?'Good afternoon':'Good evening')+', Arjun';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SCREENS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchScreen(n){
  const MAP={home:'homeScreen',analytics:'analyticsScreen',time:'timeScreen',ai:'aiScreen',settings:'settingsScreen'};
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(MAP[n]).classList.add('active');
  document.getElementById(MAP[n]).scrollTop=0;
  ['home','analytics','ai','settings'].forEach(id=>{
    document.getElementById('nav-'+id)?.classList.remove('active');
  });
  if(document.getElementById('nav-'+n))document.getElementById('nav-'+n).classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORB HEALTH ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateOrbHealth(){
  const ratio=S.expenses/S.income;
  const h=Math.max(0,Math.min(100,Math.round(100-ratio*80)));
  const orb=document.getElementById('mainOrb');
  const fill=document.getElementById('hsFill');
  document.getElementById('hsScore').textContent=h+'/100';
  document.getElementById('dsStability').textContent=h;
  fill.style.width=h+'%';
  if(h>60){
    orb.style.boxShadow='0 0 60px rgba(0,212,170,0.35),0 0 120px rgba(0,212,170,0.06),inset 0 1px 0 rgba(255,255,255,0.06)';
    orb.style.borderColor='rgba(0,212,170,0.25)';
    fill.style.background='linear-gradient(90deg,var(--teal),#00ffd2)';
    document.getElementById('hsLabel').textContent='Financial Health Â· Stable';
    document.getElementById('hsLabel').style.color='var(--teal)';
    document.getElementById('balChange').style.background='var(--teal-lo)';
    document.getElementById('balChange').style.color='var(--teal)';
    document.getElementById('dnaTypeName').textContent='Strategic Builder';
  } else if(h>35){
    orb.style.boxShadow='0 0 60px rgba(245,166,35,0.3),0 0 100px rgba(245,166,35,0.06)';
    orb.style.borderColor='rgba(245,166,35,0.3)';
    fill.style.background='linear-gradient(90deg,var(--amber),#ffd060)';
    document.getElementById('hsLabel').textContent='Financial Health Â· Caution';
    document.getElementById('hsLabel').style.color='var(--amber)';
    document.getElementById('dnaTypeName').textContent='Stabilizer';
  } else {
    orb.style.boxShadow='0 0 60px rgba(255,61,90,0.4),0 0 100px rgba(255,61,90,0.08)';
    orb.style.borderColor='rgba(255,61,90,0.3)';
    fill.style.background='linear-gradient(90deg,var(--crimson),#ff7090)';
    document.getElementById('hsLabel').textContent='Financial Health Â· Stressed';
    document.getElementById('hsLabel').style.color='var(--crimson)';
    document.getElementById('dnaTypeName').textContent='Volatile Spender';
  }
}

function updateDisplays(){
  const b=S.balance;
  const d=b>=1000?b.toLocaleString('en-US'):b.toString();
  document.getElementById('balNum').textContent=d;
  document.getElementById('orbVal').textContent='$'+d;
  document.getElementById('pmBal').textContent='$'+d;
  document.getElementById('incomeVal').textContent='$'+S.income.toLocaleString();
  document.getElementById('expVal').textContent='$'+S.expenses.toLocaleString();
  document.getElementById('savVal').textContent='$'+S.savings.toLocaleString();
  S.netWorth=S.balance+S.invest+S.savings;
  document.getElementById('netWorthNum').textContent='$'+S.netWorth.toLocaleString();
  updateOrbHealth();
  updateBurnForecast();
  // XP display
  document.getElementById('xpCurrent').textContent=(S.xp).toLocaleString()+' XP';
  document.getElementById('lcFill').style.width=((S.xp/4000)*100)+'%';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BURN FORECAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateBurnForecast(){
  const daily=Math.max(1,Math.round(S.expenses/28));
  const days=Math.min(99,Math.round(S.balance/daily));
  const pct=Math.min(1,days/60);
  const arc=169.6,off=arc*(1-pct);
  document.getElementById('burnArc').style.strokeDashoffset=off;
  document.getElementById('burnArc').style.stroke=pct>.5?'var(--teal)':pct>.25?'var(--amber)':'var(--crimson)';
  document.getElementById('burnDaysNum').textContent=days;
  document.getElementById('burnDaysText').textContent=days+' days stable';
  document.getElementById('dailyBurnVal').textContent='$'+daily+'/day';
  const projDate=new Date();projDate.setDate(projDate.getDate()+days);
  document.getElementById('burnSubText').textContent='At current rate, stable until '+projDate.toLocaleDateString('en-US',{month:'short',day:'numeric'});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TX FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function txColor(t){return{income:'var(--teal)',expense:'var(--crimson)',savings:'var(--amber)',invest:'var(--violet)'}[t]}
function txSign(t){return{income:'+',expense:'-',savings:'+',invest:''}[t]}
function renderTxFeed(){
  document.getElementById('txFeed').innerHTML=TXHISTORY.slice(0,6).map(tx=>`
    <div class="tx-row" onclick="showToast('${tx.name} Â· $${tx.amt.toLocaleString()}')">
      <div class="tx-em" style="background:${txColor(tx.type)}18">${tx.em}</div>
      <div class="tx-inf"><div class="tx-n">${tx.name}</div><div class="tx-m">${tx.date} Â· ${tx.cat}</div></div>
      <div class="tx-a" style="color:${txColor(tx.type)}">${txSign(tx.type)}$${tx.amt.toLocaleString()}</div>
    </div>`).join('');
}
function renderTxFeedAll(){
  const el=document.getElementById('txFeedAll');
  if(el)el.innerHTML=TXHISTORY.map(tx=>`
    <div class="tx-row" onclick="showToast('${tx.name}')">
      <div class="tx-em" style="background:${txColor(tx.type)}18">${tx.em}</div>
      <div class="tx-inf"><div class="tx-n">${tx.name}</div><div class="tx-m">${tx.date} Â· ${tx.cat}</div></div>
      <div class="tx-a" style="color:${txColor(tx.type)}">${txSign(tx.type)}$${tx.amt.toLocaleString()}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TX SHEET
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openTx(type){
  S.txType=type;S.txAmt='0';S.txCat=null;
  setTxType(type);
  document.getElementById('txSheet').style.display='flex';
  requestAnimationFrame(()=>document.getElementById('txSheet').classList.add('open'));
}
function closeTx(){document.getElementById('txSheet').classList.remove('open');setTimeout(()=>document.getElementById('txSheet').style.display='none',460)}
function closeTxBg(e){if(e.target===document.getElementById('txSheet'))closeTx()}

function setTxType(t){
  S.txType=t;S.txAmt='0';S.txCat=null;
  ['income','expense','savings','invest'].forEach(x=>{const el=document.getElementById('tt-'+x);if(el){el.className='ttab';if(x===t)el.classList.add('on-'+t)}});
  const col=TYPECOLORS[t];
  document.getElementById('txBig').style.color=col;
  document.getElementById('txCursorEl').style.background=col;
  document.getElementById('txConfirmBtn').style.background=col;
  document.getElementById('txConfirmBtn').style.color=t==='invest'?'var(--text)':'var(--void)';
  document.getElementById('txAmtSpan').textContent='0';
  document.getElementById('txCatRow').textContent='Select category below';
  document.getElementById('txNote').value='';
  renderCatsScroll();
}
function renderCatsScroll(){
  document.getElementById('txCatsScroll').innerHTML=(CATS[S.txType]||[]).map(c=>`
    <div class="tx-cat-pill" style="color:${TYPECOLORS[S.txType]}" onclick="pickCat(this,'${c}')">${c}</div>`).join('');
}
function pickCat(el,c){
  document.querySelectorAll('.tx-cat-pill').forEach(x=>{x.classList.remove('on');x.style.borderColor='var(--rim)'});
  el.classList.add('on');el.style.borderColor=TYPECOLORS[S.txType];
  S.txCat=c;document.getElementById('txCatRow').textContent='Â· '+c;
}
function tn(k){
  if(k==='del'){S.txAmt=S.txAmt.length>1?S.txAmt.slice(0,-1):'0'}
  else if(k==='.'){if(!S.txAmt.includes('.'))S.txAmt+='.'}
  else{if(S.txAmt==='0')S.txAmt=k;else if(S.txAmt.length<10)S.txAmt+=k}
  const v=parseFloat(S.txAmt)||0;
  document.getElementById('txAmtSpan').textContent=v>=1000?v.toLocaleString('en-US',{maximumFractionDigits:2}):S.txAmt;
}
function confirmTx(){
  const amt=parseFloat(S.txAmt)||0;
  if(!amt){closeTx();return}
  processTx(S.txType,amt,S.txCat);closeTx();
}
function processTx(type,amount,cat){
  S.balance=Math.max(0,S.balance+TYPESIGN[type]*amount);
  if(type==='income')S.income+=amount;
  if(type==='expense')S.expenses+=amount;
  if(type==='savings')S.savings+=amount;
  if(type==='invest')S.invest+=amount;
  S.xp+=Math.max(5,Math.round(amount/40));
  if(S.xp>=4000){S.xp-=4000;S.level++;fireMilestone('ğŸ† Level '+S.level,'Financial power unlocked!')}
  if(type==='expense'&&amount>300){triggerShock();triggerCracks()}
  if(type==='savings'&&S.savings>=2000)fireMilestone('ğŸ¯ Savings Milestone','$2,000 emergency fund reached!');
  const emojis={income:'ğŸ’°',expense:'ğŸ’¸',savings:'ğŸ¦',invest:'ğŸ“Š'};
  TXHISTORY.unshift({type,em:cat?cat.split(' ')[0]:emojis[type],name:cat?cat.split(' ').slice(1).join(' ')||type:type,amt:amount,date:'Just now',cat:cat||type});
  updateDisplays();renderTxFeed();renderTxFeedAll();
  const o=document.getElementById('mainOrb').getBoundingClientRect();
  spawnParticles(o.left+o.width/2,o.top+o.height/2,TYPECOLORS[type],14);
  showToast('$'+amount.toLocaleString()+' '+type+' recorded âœ“');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GESTURE INPUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(()=>{
  const stage=document.getElementById('orbStage');
  let sy=0,dragging=false,gtype=null;
  const ind=document.createElement('div');
  ind.style.cssText='position:fixed;pointer-events:none;z-index:50;display:none;text-align:center;left:50%;transform:translateX(-50%)';
  ind.innerHTML='<div id="gi-circle" style="width:58px;height:58px;border-radius:50%;border:2px solid;display:flex;align-items:center;justify-content:center;margin:0 auto 5px;font-size:22px;backdrop-filter:blur(8px)"></div><div id="gi-amt" style="font-family:var(--f-serif);font-size:17px"></div>';
  document.body.appendChild(ind);
  stage.addEventListener('touchstart',e=>{sy=e.touches[0].clientY;dragging=false;gtype=null},{passive:true});
  stage.addEventListener('touchmove',e=>{
    const dy=sy-e.touches[0].clientY;if(Math.abs(dy)<12)return;
    dragging=true;gtype=dy>0?'income':'expense';
    const amt=Math.round(Math.abs(dy)*2.8);
    ind.style.display='block';ind.style.top=(e.touches[0].clientY-80)+'px';
    const col=gtype==='income'?'var(--teal)':'var(--crimson)';
    const gc=document.getElementById('gi-circle');gc.style.borderColor=col;gc.style.color=col;gc.style.background=gtype==='income'?'rgba(0,212,170,0.1)':'rgba(255,61,90,0.1)';gc.textContent=gtype==='income'?'â†‘':'â†“';
    document.getElementById('gi-amt').style.color=col;document.getElementById('gi-amt').textContent='$'+amt;
  },{passive:true});
  stage.addEventListener('touchend',e=>{
    ind.style.display='none';if(!dragging||!gtype)return;
    const dy=sy-e.changedTouches[0].clientY;const amt=Math.max(10,Math.round(Math.abs(dy)*2.8));
    processTx(gtype,amt,null);dragging=false;gtype=null;
  });
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORB TAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function orbTap(){
  const o=document.getElementById('mainOrb');o.style.transform='scale(0.92)';setTimeout(()=>o.style.transform='',250);
  const rect=o.getBoundingClientRect();spawnParticles(rect.left+rect.width/2,rect.top+rect.height/2,'var(--teal)',10);
  showToast('Balance: $'+S.balance.toLocaleString());
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TIMELINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildTimeline(){
  document.getElementById('tlScroll').innerHTML=MONTHS.map((m,i)=>`
    <div class="tl-pill ${i===S.selectedMonth?'active':''}" onclick="selMonth(${i})">${m.name}</div>`).join('');
}
function selMonth(i){
  S.selectedMonth=i;buildTimeline();renderBarChart(i);
  const m=MONTHS[i];
  document.getElementById('mdcName').textContent=m.name;
  document.getElementById('mdcBal').textContent='$'+m.bal.toLocaleString();
}
function renderBarChart(i){
  const m=MONTHS[i];const mx=Math.max(m.income,m.exp,m.sav,m.inv)+200;
  document.getElementById('barChart').innerHTML=[
    {v:m.income,c:'var(--teal)',l:'Inc'},
    {v:m.sav,c:'var(--amber)',l:'Sav'},
    {v:m.exp,c:'var(--crimson)',l:'Exp'},
    {v:m.inv,c:'var(--violet)',l:'Inv'},
  ].map(b=>`<div class="bc-col"><div class="bc-bar-wrap"><div class="bc-bar" style="height:${Math.round(b.v/mx*96)}px;background:${b.c}22;border-top:2px solid ${b.c}" title="$${b.v.toLocaleString()}"></div></div><div class="bc-l">${b.l}</div></div>`).join('');
}
function triggerRewind(){
  showToast('â® Rewinding history...');
  let i=0;const iv=setInterval(()=>{selMonth(i++);if(i>=MONTHS.length){clearInterval(iv);showToast('âœ“ History complete')}},380);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DONUT CHART â€” Canvas
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildDonut(){
  const cv=document.getElementById('donutCanvas');const ctx=cv.getContext('2d');
  const data=[
    {label:'Housing',val:1200,color:'#a78bfa'},
    {label:'Food',val:420,color:'#00d4aa'},
    {label:'Bills',val:640,color:'#f5a623'},
    {label:'Fun',val:580,color:'#ff3d5a'},
  ];
  const total=data.reduce((a,d)=>a+d.val,0);
  let angle=-Math.PI/2;
  ctx.clearRect(0,0,110,110);
  data.forEach(d=>{
    const slice=(d.val/total)*Math.PI*2;
    ctx.beginPath();ctx.moveTo(55,55);ctx.arc(55,55,48,angle,angle+slice);ctx.fillStyle=d.color+'33';ctx.fill();
    ctx.beginPath();ctx.arc(55,55,48,angle,angle+slice);ctx.arc(55,55,32,angle+slice,angle,true);ctx.fillStyle=d.color;ctx.fill();
    angle+=slice;
  });
  ctx.beginPath();ctx.arc(55,55,30,0,Math.PI*2);ctx.fillStyle='#0d1420';ctx.fill();
  ctx.font='bold 12px Georgia';ctx.fillStyle='#e8eef8';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText('$'+Math.round(total/100)/10+'k',55,55);
  document.getElementById('donutLegend').innerHTML=data.map(d=>`<div class="dl-item"><div class="dl-dot" style="background:${d.color}"></div><div class="dl-label">${d.label}</div><div class="dl-pct">${Math.round(d.val/total*100)}%</div></div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TREND LINE CHART â€” Canvas
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildTrendChart(){
  const cv=document.getElementById('trendCanvas');
  cv.width=cv.offsetWidth||340;cv.height=140;
  const ctx=cv.getContext('2d');
  const vals=MONTHS.map(m=>m.bal);
  const min=Math.min(...vals)-500,max=Math.max(...vals)+500;
  const pad=16;const w=cv.width-pad*2;const h=cv.height-pad*2;
  const pts=vals.map((v,i)=>({x:pad+i*(w/(vals.length-1)),y:pad+h-(v-min)/(max-min)*h}));
  // Gradient fill
  const grad=ctx.createLinearGradient(0,0,0,cv.height);grad.addColorStop(0,'rgba(0,212,170,0.15)');grad.addColorStop(1,'rgba(0,212,170,0)');
  ctx.beginPath();ctx.moveTo(pts[0].x,cv.height);
  pts.forEach(p=>ctx.lineTo(p.x,p.y));
  ctx.lineTo(pts[pts.length-1].x,cv.height);
  ctx.closePath();ctx.fillStyle=grad;ctx.fill();
  // Line
  ctx.beginPath();pts.forEach((p,i)=>i===0?ctx.moveTo(p.x,p.y):ctx.lineTo(p.x,p.y));
  ctx.strokeStyle='var(--teal)';ctx.lineWidth=2;ctx.lineJoin='round';ctx.stroke();
  // Dots
  pts.forEach((p,i)=>{
    ctx.beginPath();ctx.arc(p.x,p.y,4,0,Math.PI*2);
    ctx.fillStyle=i===pts.length-1?'var(--teal)':'#0d1420';
    ctx.strokeStyle='var(--teal)';ctx.lineWidth=2;ctx.fill();ctx.stroke();
    ctx.font='9px DM Mono,monospace';ctx.fillStyle='rgba(232,238,248,0.4)';ctx.textAlign='center';
    ctx.fillText(MONTHS[i].name.slice(0,3),p.x,cv.height-2);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HEATMAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildHeatmap(){
  const vals=Array.from({length:28},()=>Math.random());
  const maxV=Math.max(...vals);
  document.getElementById('heatmapGrid').innerHTML=vals.map((v,i)=>{
    const intensity=v/maxV;const alpha=0.08+intensity*0.85;
    const color=intensity>0.7?`rgba(255,61,90,${alpha})`:intensity>0.4?`rgba(245,166,35,${alpha})`:`rgba(0,212,170,${alpha})`;
    return`<div class="hm-cell" style="background:${color}" title="Feb ${i+1}: $${Math.round(v*200)} spent" onclick="showToast('Feb ${i+1} Â· $${Math.round(v*200)} spent')"></div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUDGET TRACKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildBudget(){
  const budgets=[
    {em:'ğŸœ',name:'Food & Dining',spent:420,limit:600},
    {em:'ğŸšŒ',name:'Transport',spent:180,limit:300},
    {em:'ğŸ®',name:'Entertainment',spent:580,limit:400},
    {em:'ğŸ’Š',name:'Health',spent:80,limit:200},
    {em:'ğŸ‘—',name:'Shopping',spent:320,limit:300},
  ];
  document.getElementById('budgetList').innerHTML=budgets.map(b=>{
    const pct=Math.min(100,Math.round(b.spent/b.limit*100));
    const over=b.spent>b.limit;
    const col=over?'var(--crimson)':pct>75?'var(--amber)':'var(--teal)';
    return`<div class="bp-item">
      <div class="bp-cat">${b.em}</div>
      <div class="bp-info">
        <div class="bp-name">${b.name}${over?' âš ':''}</div>
        <div class="bp-row">
          <div class="bp-spent" style="color:${col}">$${b.spent}</div>
          <div class="bp-bar"><div class="bp-fill" style="width:${pct}%;background:${col}"></div></div>
          <div class="bp-limit">/$${b.limit}</div>
        </div>
      </div>
    </div>`;
  }).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PATTERNS & CHALLENGES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPatterns(){
  const pats=[
    {icon:'ğŸ’š',bg:'var(--teal-lo)',type:'DISCIPLINE',color:'var(--teal)',head:'12-month saving streak',desc:'You\'ve saved consistently for 12 months. System stability reinforcing.'},
    {icon:'âš¡',bg:'var(--amber-lo)',type:'IMPULSE SPIKE',color:'var(--amber)',head:'Weekend spend spikes',desc:'Saturday spend is 2.3Ã— higher than weekdays. Possible impulse pattern.'},
    {icon:'ğŸ”®',bg:'var(--vio-lo)',type:'GROWTH',color:'var(--violet)',head:'Investment compounding',desc:'ETF positions growing at 14% annualized. Compound acceleration detected.'},
    {icon:'ğŸ©¸',bg:'var(--crim-lo)',type:'LEAKAGE',color:'var(--crimson)',head:'Subscription creep: $127/mo',desc:'6 recurring charges unreviewed. Small amounts accumulating silently.'},
  ];
  document.getElementById('patternsGrid').innerHTML=`<div class="section-title">Detected Patterns</div>`+
  pats.map(p=>`<div class="pat-card" onclick="showToast('${p.head}')">
    <div class="pat-icon" style="background:${p.bg}">${p.icon}</div>
    <div class="pat-body"><div class="pat-type" style="color:${p.color}">${p.type}</div><div class="pat-head">${p.head}</div><div class="pat-desc">${p.desc}</div></div>
  </div>`).join('');
}
function buildChallenges(){
  const chs=[
    {badge:'7-DAY SPRINT',bclr:'var(--teal)',title:'Stability Challenge',desc:'Zero impulse purchases for 7 days.',prog:71,left:'2 days left',glow:'rgba(0,212,170,0.08)'},
    {badge:'CONTROLLED',bclr:'var(--violet)',title:'Spending Detox',desc:'Reduce monthly expenses by 20%. Currently at 57% of budget.',prog:57,left:'16 days left',glow:'rgba(167,139,250,0.06)'},
    {badge:'RESILIENCE',bclr:'var(--amber)',title:'Budget Fortress',desc:'Build 6-month emergency fund. You\'re 36% there.',prog:36,left:'ongoing',glow:'rgba(245,166,35,0.06)'},
  ];
  document.getElementById('challengeList').innerHTML=chs.map(c=>`
    <div class="ch-card" onclick="showToast('Challenge: ${c.title}')">
      <div class="ch-glow" style="background:${c.glow}"></div>
      <span class="ch-badge" style="background:${c.bclr}18;color:${c.bclr};border:1px solid ${c.bclr}44">${c.badge}</span>
      <div class="ch-title">${c.title}</div>
      <div class="ch-desc">${c.desc}</div>
      <div class="ch-prog-label"><span>${c.prog}% complete</span><span>${c.left}</span></div>
      <div class="ch-prog-bar"><div class="ch-prog-fill" style="width:${c.prog}%;background:${c.bclr}"></div></div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACCOUNTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildAccounts(){
  const accs=[
    {em:'ğŸ¦',name:'HDFC Savings',type:'Primary Bank',bal:'$8,200',col:'var(--teal)'},
    {em:'ğŸ’³',name:'Visa Platinum',type:'Credit Card Â· Due Mar 5',bal:'-$340',col:'var(--crimson)'},
    {em:'ğŸ“²',name:'PhonePe Wallet',type:'UPI Â· Instant transfer',bal:'$480',col:'var(--violet)'},
    {em:'ğŸ“ˆ',name:'Zerodha Portfolio',type:'Stocks Â· ETF',bal:'$3,560',col:'var(--amber)'},
  ];
  document.getElementById('accList').innerHTML=accs.map(a=>`
    <div class="acc-card" onclick="showToast('${a.name} Â· ${a.bal}')">
      <div class="acc-icon" style="background:${a.col}18">${a.em}</div>
      <div class="acc-info"><div class="acc-name">${a.name}</div><div class="acc-type">${a.type}</div></div>
      <div class="acc-bal" style="color:${a.col}">${a.bal}</div>
      <div class="acc-dot" style="background:var(--teal);box-shadow:0 0 6px var(--teal-glo)"></div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildNotifs(){
  const notifs=[
    {icon:'âš¡',title:'Budget Alert',msg:'Entertainment spending is 45% over budget this month.',time:'2 min ago',col:'var(--crimson)'},
    {icon:'ğŸ¯',title:'Savings Milestone',msg:'You\'re 36% towards your $5,000 emergency fund goal!',time:'1 hour ago',col:'var(--teal)'},
    {icon:'ğŸ“ˆ',title:'Investment Update',msg:'Your ETF portfolio gained +2.3% this week.',time:'Yesterday',col:'var(--violet)'},
    {icon:'âš ï¸',title:'Bill Due Soon',msg:'Electricity bill of $320 due in 3 days.',time:'2 days ago',col:'var(--amber)'},
  ];
  document.getElementById('notifList').innerHTML=notifs.map(n=>`
    <div class="notif-item">
      <div class="notif-icon">${n.icon}</div>
      <div class="notif-body"><div class="notif-title">${n.title}</div><div class="notif-msg">${n.msg}</div><div class="notif-time">${n.time}</div></div>
      <div class="notif-dot" style="background:${n.col}"></div>
    </div>`).join('');
}
function openNotifs(){document.getElementById('notifPanel').classList.add('open')}
function closeNotifs(){document.getElementById('notifPanel').classList.remove('open')}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EMERGENCY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function runEM(type){
  const sc={
    job:{t:'Job Loss Simulation',s:'Zero income â€” current expenses only',days:Math.round(S.balance/98),det:'$'+S.balance.toLocaleString()+' Ã· $98/day',pct:38,tips:['Cut food by 30% â†’ <em>+22 days</em>','Pause investments â†’ <em>+41 days</em>','Pause savings targets â†’ <em>+18 days</em>']},
    income50:{t:'-50% Income Shock',s:'Half your income for 6 months',days:Math.round(S.balance/45),det:'Reduced to $'+Math.round(S.income*.5).toLocaleString()+'/month',pct:64,tips:['Reduce discretionary â†’ <em>+35 days</em>','Part-time freelance â†’ <em>+60 days</em>']},
    crisis:{t:'Market Crisis Mode',s:'Investments -40%, costs +20%',days:Math.round(S.balance*.65/118),det:'Portfolio: $'+Math.round(S.invest*.6).toLocaleString()+', costs +20%',pct:28,tips:['Liquidate ETF â†’ <em>+34 days</em>','Emergency fund â†’ <em>buffer: 3 months</em>']},
  }[type];
  document.getElementById('emTitle').textContent=sc.t;
  document.getElementById('emSubText').textContent=sc.s;
  document.getElementById('emDays').textContent=sc.days;
  document.getElementById('emDetail').textContent=sc.det;
  document.getElementById('emTips').innerHTML=sc.tips.map(t=>`<div class="em-tip">ğŸ’¡ ${t}</div>`).join('');
  document.getElementById('emBarFill').style.width='0%';
  document.getElementById('emModal').style.display='flex';
  document.getElementById('emModal').classList.add('open');
  setTimeout(()=>document.getElementById('emBarFill').style.width=sc.pct+'%',100);
}
function closeEM(){document.getElementById('emModal').classList.remove('open');setTimeout(()=>document.getElementById('emModal').style.display='none',300)}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EFFECTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function triggerShock(){
  const s=document.getElementById('shockOverlay');s.classList.add('on');setTimeout(()=>s.classList.remove('on'),700);
  if(navigator.vibrate)navigator.vibrate([80,30,80]);
}
function triggerCracks(){
  for(let i=0;i<5;i++)setTimeout(()=>{
    const c=document.createElement('div');c.className='crack';
    const r=(-25+Math.random()*50)+'deg';
    c.style.cssText=`left:${10+Math.random()*80}%;top:${5+Math.random()*50}%;height:${25+Math.random()*70}px;--r:${r}`;
    document.body.appendChild(c);setTimeout(()=>c.remove(),1600);
  },i*100);
}
function fireMilestone(title,sub){
  const m=document.getElementById('msOverlay');
  document.getElementById('msTitle').textContent=title;
  document.getElementById('msSub').textContent=sub;
  m.classList.add('on');
  spawnParticles(innerWidth/2,innerHeight/2,'var(--teal)',28);
  if(navigator.vibrate)navigator.vibrate([100,50,100,50,200]);
  setTimeout(()=>m.classList.remove('on'),2600);
}
function spawnParticles(cx,cy,color,count){
  for(let i=0;i<count;i++){
    const p=document.createElement('div');const sz=2+Math.random()*4;
    const a=Math.random()*Math.PI*2;const d=60+Math.random()*150;
    const tx=`translate(${Math.cos(a)*d}px,${Math.sin(a)*d}px)`;
    p.className='particle';
    p.style.cssText=`left:${cx-sz/2}px;top:${cy-sz/2}px;width:${sz}px;height:${sz}px;background:${color};box-shadow:0 0 ${sz*2}px ${color};--tx:${tx};--d:${.7+Math.random()*.8}s;animation-delay:${Math.random()*.12}s`;
    document.body.appendChild(p);setTimeout(()=>p.remove(),1500);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PASSIVE MODE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPassiveBars(){
  document.getElementById('pmBars').innerHTML=Array.from({length:8},(_,i)=>`
    <div class="pm-bar" style="background:var(--teal);height:${12+Math.random()*22}px;animation-duration:${.5+i*.12}s;animation-delay:${i*.07}s"></div>`).join('');
}
function enterPassive(){document.getElementById('passiveMode').style.display='flex'}
function exitPassive(){document.getElementById('passiveMode').style.display='none'}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT & SHARE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function exportPDF(){
  showToast('ğŸ“„ Generating report...');
  setTimeout(()=>{
    // Simulate export with financial data
    const data=`TrackMyMoney â€” Financial Report\nFebruary 2026\n\nBalance: $${S.balance.toLocaleString()}\nIncome: $${S.income.toLocaleString()}\nExpenses: $${S.expenses.toLocaleString()}\nSavings: $${S.savings.toLocaleString()}\nInvestments: $${S.invest.toLocaleString()}\nNet Worth: $${S.netWorth.toLocaleString()}\n\nGenerated: ${new Date().toLocaleString()}`;
    const blob=new Blob([data],{type:'text/plain'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download='TrackMyMoney_Feb2026.txt';a.click();
    URL.revokeObjectURL(url);
    showToast('âœ“ Report downloaded');
  },1500);
}
function shareLink(){
  const url=`${location.origin}?view=readonly&id=${btoa(Date.now()+'').slice(0,8)}`;
  if(navigator.share){
    navigator.share({title:'TrackMyMoney Dashboard',text:'My financial overview',url}).catch(()=>copyLink(url));
  } else copyLink(url);
}
function copyLink(url){
  navigator.clipboard?.writeText(url).then(()=>showToast('ğŸ”— Read-only link copied!')).catch(()=>showToast('Link: '+url));
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg){
  const t=document.getElementById('toast');
  document.getElementById('toastMsg').textContent=msg;
  t.classList.add('show');clearTimeout(window._tt);
  window._tt=setTimeout(()=>t.classList.remove('show'),2800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INSTALL PROMPT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let deferredPrompt;
window.addEventListener('beforeinstallprompt',e=>{
  e.preventDefault();deferredPrompt=e;
  setTimeout(()=>showToast('ğŸ“² Add TrackMyMoney to your home screen!'),3000);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATE & LIVE UPDATES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
setInterval(()=>{
  // Simulate live data breathing
  const fluctuation=(Math.random()-.5)*10;
  // subtle orb breathing already handled by CSS
},5000);
</script>
</body>
</html>
